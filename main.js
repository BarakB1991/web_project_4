!function(){"use strict";var e=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}resetValidation(){this._inputElements.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState(this._inputElements,this._buttonElement)}_hideInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._inputElements.some((e=>!e.validity.valid))?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_showInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class r{constructor(e){let{cardData:r,cardTemplateSelector:s,onImageClick:n,userId:i,handleDeleteCardClick:o,handleLikeCardClick:a}=e;t(this,"_renderLikeContainer",(()=>{this._element.querySelector(".card__like-counter").textContent=this._likeCounter.length,this.isLikedByUser()?this._addLikeButton():this._removeLikeButton()})),t(this,"removeCardElement",(()=>{this._element.remove(),this._element=null})),t(this,"_addEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>this._handleLikeCardClick(this._cardId)));const e=this._element.querySelector(".card__delete-btn");this._cardUserId===this._userId?e.addEventListener("click",(()=>this._handleDeleteCardClick(this._cardId))):e.remove(),this._element.querySelector(".card__img").addEventListener("click",(()=>this._handlePreviewPicture()))})),t(this,"_removeLikeButton",(()=>{this._likeButton.classList.remove("card__like-btn_active")})),t(this,"_addLikeButton",(()=>{this._likeButton.classList.add("card__like-btn_active")})),t(this,"_handlePreviewPicture",(()=>{this._onImageClick({link:this._link,name:this._name})})),t(this,"renderCard",(()=>{this._element=this._template.cloneNode(!0);const e=this._element.querySelector(".card__img"),t=this._element.querySelector(".card__like-counter");return e.src=this._link,e.alt=this._name,t.textContent=this._likeCounter.length,this._element.querySelector(".card__title").textContent=this._name,this._likeButton=this._element.querySelector(".card__like-btn"),this._addEventListeners(),this._renderLikeContainer(),this._element})),this._name=r.name,this._link=r.link,this._cardUserId=r.owner._id,this._cardId=r._id,this._likeCounter=r.likes,this._userId=i,this._onImageClick=n,this._handleDeleteCardClick=o,this._handleLikeCardClick=a,this._template=document.querySelector(s).content.querySelector(".card")}isLikedByUser(){return this._likeCounter.some((e=>e._id===this._userId))}updateLikeCounter(e){this._likeCounter=e.likes,this._renderLikeContainer()}}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class n{constructor(e){s(this,"_handleMouseDown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-btn"))&&this.close()})),s(this,"_handleEscClose",(e=>{e.preventDefault(),"Escape"===e.key&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_visible"),document.addEventListener("keyup",this._handleEscClose),this._popup.addEventListener("mousedown",this._handleMouseDown)}close(){this._popup.classList.remove("popup_visible"),document.removeEventListener("keyup",this._handleEscClose),this._popup.removeEventListener("mousedown",this._handleMouseDown)}}class i extends n{constructor(e,t){super(e),this.handleSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._originalButtonText=this._form.querySelector('button[type="submit"]').textContent}_getInputValues(){const e=[...this._form.querySelectorAll(".popup__input")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}renderLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Saving..."}removeLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent=this._originalButtonText}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.handleSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}}const o=document.querySelector(".popup_type_edit-profile"),a=document.querySelector(".popup_type_add-card"),l=document.querySelector(".popup_type_edit-avatar"),u=document.querySelector(".profile"),c=u.querySelector(".profile__name"),d=u.querySelector(".profile__about"),h=u.querySelector(".profile__img"),_=document.querySelector(".popup_type_image"),p=(_.querySelector(".popup__title_type_image"),_.querySelector(".popup__image"),u.querySelector(".profile__edit-btn")),m=u.querySelector(".profile__add-btn"),v=document.querySelector(".profile__img-button"),y=(document.querySelector(".cards__list"),{inputSelector:".popup__input",submitButtonSelector:".popup__submit-btn",inactiveButtonClass:"popup__submit-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),b=(document.querySelector("#add-card-form"),document.querySelector("#edit-profile-form")),C=b.querySelector("#input-name"),k=b.querySelector("#input-profession");function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const g=new class{constructor(e){let{userName:t,userAbout:r,avatar:s,userId:n}=e;this._userName=t,this._userAbout=r,this._avatar=s,this._userId=n}getUserInfo(){return{userName:this._userName.textContent,userAbout:this._userAbout.textContent,avatar:this._avatar}}setUserInfo(e){let{userName:t,userAbout:r}=e;this._userName.textContent=t,this._userAbout.textContent=r}setUserAvatar(e){this._avatar.src=e}setUserId(e){this._userId.id=e}}({userName:c,userAbout:d,avatar:h,userId:u}),L=new class{constructor(e){f(this,"removeUserCard",(e=>fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"addLike",(e=>fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"removeLike",(e=>fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"editAvatar",(e=>fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>this._getResponseData(e))))),this._url=e.baseUrl,this._token=e.token}getCardsAndUserData(){return Promise.all([this.getUserData(),this.getInitialCards()])}getInitialCards(){return fetch("".concat(this._url,"/cards"),{headers:{authorization:this._token}}).then((e=>this._getResponseData(e)))}getUserData(){return fetch("".concat(this._url,"/users/me"),{headers:{authorization:this._token}}).then((e=>this._getResponseData(e)))}editProfile(e,t){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>this._getResponseData(e)))}addNewCard(e,t){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:{authorization:this._token,"content-type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((e=>this._getResponseData(e)))}_getResponseData(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",token:"c785e696-84a9-4aca-b3d2-750b2694b444"}),E=new class extends n{constructor(e){var t,r;super(e),r=e=>{e.preventDefault(),this._handleSubmit()},(t="_setEventListeners")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this._form=this._popup.querySelector(".popup__form")}setSubmitHandler(e){this._handleSubmit=e}renderLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Loading..."}removeLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Yes"}open(){super.open(),this._form.addEventListener("submit",this._setEventListeners)}close(){super.close(),this._form.removeEventListener("submit",this._setEventListeners)}}(".popup_type_confirm"),S=new class extends n{constructor(e){var t,r;super(e),r=e=>{let{link:t,name:r}=e;super.open();const s=this._popup.querySelector(".popup__title_type_image"),n=this._popup.querySelector(".popup__image");s.textContent=r,n.src=t,n.alt=r},(t="open")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this.open=r}}(".popup_type_image");function q(e){const t=new r({cardData:e,cardTemplateSelector:"#card-template",onImageClick:S.open,userId:u.id,handleDeleteCardClick:e=>{E.open(),E.setSubmitHandler((()=>{E.renderLoadingOnButton(),L.removeUserCard(e).then((()=>{t.removeCardElement(),E.close()})).catch((e=>console.log(e))).finally((()=>{E.removeLoadingOnButton()}))}))},handleLikeCardClick:e=>{1==t.isLikedByUser()?L.removeLike(e).then((e=>t.updateLikeCounter(e))).catch((e=>console.log(e))):L.addLike(e).then((e=>t.updateLikeCounter(e))).catch((e=>console.log(e)))}}),s=t.renderCard();I.addItem(s)}const I=new class{constructor(e,t){let{renderer:r}=t;this._renderer=r,this._container=document.querySelector(e)}addItem(e){this._container.prepend(e)}renderer(e){this._items=e,this._items.forEach((e=>{this._renderer(e)}))}}(".cards__list",{renderer:q}),B=new i(".popup_type_edit-profile",(async e=>{let{name:t,profession:r}=e;B.renderLoadingOnButton();try{await L.editProfile(t,r)&&(g.setUserInfo({userName:t,userAbout:r}),B.close())}catch(e){console.log("Could not perform request: ".concat(e))}B.removeLoadingOnButton()})),w=new i(".popup_type_add-card",(async e=>{const{cardtitle:t,imagelink:r}=e;w.renderLoadingOnButton();try{const e=await L.addNewCard(t,r);e&&(q(e),w.close())}catch(e){console.log("Could not perform request: ".concat(e))}w.removeLoadingOnButton()})),D=new i(".popup_type_edit-avatar",(async e=>{const{avatar:t}=e;D.renderLoadingOnButton();try{await L.editAvatar(t)&&(g.setUserAvatar(t),D.close())}catch(e){console.log("Could not perform request: ".concat(e))}D.removeLoadingOnButton()}));B.setEventListeners(),w.setEventListeners(),D.setEventListeners();const U=new e(y,a),A=new e(y,o),O=new e(y,l);v.addEventListener("click",(()=>{D.open(),O.resetValidation()})),p.addEventListener("click",(()=>{B.open(),function(){const{userName:e,userAbout:t}=g.getUserInfo();C.value=e,k.value=t}(),A.resetValidation()})),m.addEventListener("click",(()=>{w.open(),U.resetValidation()})),U.enableValidation(),A.enableValidation(),O.enableValidation(),L.getCardsAndUserData().then((e=>{let[t,r]=e;g.setUserInfo({userName:t.name,userAbout:t.about}),g.setUserAvatar(t.avatar),g.setUserId(t._id),I.renderer(r)})).catch((e=>console.log(e)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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b0gsRUFBa0IvTCxxQkFHcEIrTCxFQUFrQnZLLG1CQUNsQnlLLEVBQXFCekssbUJBQ3JCMEssRUFBb0IxSyxtQkFFcEIrRixFQUNHaUIsc0JBQ0FSLE1BQUssSUFBdUIsSUFBckJvRSxFQUFVQyxHQUFXLEVBQzNCekYsRUFBU1EsWUFBWSxDQUNuQlAsU0FBVXVGLEVBQVNqSixLQUNuQjJELFVBQVdzRixFQUFTdEQsUUFFdEJsQyxFQUFTUyxjQUFjK0UsRUFBU3JGLFFBQ2hDSCxFQUFTVSxVQUFVOEUsRUFBU3RJLEtBQzVCMkcsRUFBWUcsU0FBU3lCLE1BRXRCckMsT0FBTUMsR0FBT0MsUUFBUUMsSUFBSUYsSyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVsZW1lbnRzLCB0aGlzLl9idXR0b25FbGVtZW50KTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuXHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IHRoaXMuX2lucHV0RWxlbWVudHMuc29tZShpbnB1dEVsZW1lbnQgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgICBpZiAoaGFzSW52YWxpZElucHV0KSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuXHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07IC8vIG1hZGUgYXJyYXkgb2Ygbm9kZUxpc3RcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZXZ0ID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7Y2FyZERhdGEsIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLCBvbkltYWdlQ2xpY2ssIHVzZXJJZCwgaGFuZGxlRGVsZXRlQ2FyZENsaWNrLCBoYW5kbGVMaWtlQ2FyZENsaWNrfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRVc2VySWQgPSBjYXJkRGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBjYXJkRGF0YS5faWQ7XHJcbiAgICB0aGlzLl9saWtlQ291bnRlciA9IGNhcmREYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG5cclxuICAgIHRoaXMuX29uSW1hZ2VDbGljayA9IG9uSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmRDbGljayA9IGhhbmRsZURlbGV0ZUNhcmRDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkQ2xpY2sgPSBoYW5kbGVMaWtlQ2FyZENsaWNrO1xyXG5cclxuICAgIHRoaXMuX3RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjYXJkVGVtcGxhdGVTZWxlY3RvcikuY29udGVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZEJ5VXNlcigpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlQ291bnRlci5zb21lKGxpa2UgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaWtlQ291bnRlcihjYXJkRGF0YSkge1xyXG4gICAgdGhpcy5fbGlrZUNvdW50ZXIgPSBjYXJkRGF0YS5saWtlcztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VDb250YWluZXIoKTtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMaWtlQ29udGFpbmVyID0gKCkgPT4ge1xyXG4gICAgY29uc3QgbGlrZUNvdW50ZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50ZXInKTtcclxuICAgIGxpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZUNvdW50ZXIubGVuZ3RoO1xyXG5cclxuICAgICF0aGlzLmlzTGlrZWRCeVVzZXIoKSA/IHRoaXMuX3JlbW92ZUxpa2VCdXR0b24oKSA6IHRoaXMuX2FkZExpa2VCdXR0b24oKTtcclxuICB9O1xyXG5cclxuICByZW1vdmVDYXJkRWxlbWVudCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9O1xyXG5cclxuICBfYWRkRXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUNhcmRDbGljayh0aGlzLl9jYXJkSWQpKTtcclxuXHJcbiAgICBjb25zdCBkZWxldGVDYXJkQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ0bicpO1xyXG4gICAgaWYgKHRoaXMuX2NhcmRVc2VySWQgPT09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICBkZWxldGVDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2FyZENsaWNrKHRoaXMuX2NhcmRJZCkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZGVsZXRlQ2FyZEJ1dHRvbi5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwcmV2aWV3UGljdHVyZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltZycpO1xyXG4gICAgcHJldmlld1BpY3R1cmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVQcmV2aWV3UGljdHVyZSgpKTtcclxuICB9O1xyXG5cclxuICBfcmVtb3ZlTGlrZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1idG5fYWN0aXZlJyk7XHJcbiAgfTtcclxuXHJcbiAgX2FkZExpa2VCdXR0b24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnRuX2FjdGl2ZScpO1xyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVQcmV2aWV3UGljdHVyZSA9ICgpID0+IHtcclxuICAgIHRoaXMuX29uSW1hZ2VDbGljayh7bGluazogdGhpcy5fbGluaywgbmFtZTogdGhpcy5fbmFtZX0pO1xyXG4gIH07XHJcblxyXG4gIHJlbmRlckNhcmQgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fdGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1nJyk7XHJcbiAgICBjb25zdCBjYXJkTGlrZUNvdW50ZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50ZXInKTtcclxuICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICBjYXJkTGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlQ291bnRlci5sZW5ndGg7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ0bicpO1xyXG4gICAgdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlQ29udGFpbmVyKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX3Zpc2libGUnKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlTW91c2VEb3duKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfdmlzaWJsZScpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB0aGlzLl9wb3B1cC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVNb3VzZURvd24pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZU1vdXNlRG93biA9IGV2dCA9PiB7XHJcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwJykgfHwgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZS1idG4nKSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gZXZ0ID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTsgLy8gdGhpcy5fcG9wdXBcclxuICAgIHRoaXMuaGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xyXG4gICAgdGhpcy5fb3JpZ2luYWxCdXR0b25UZXh0ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpXTtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcblxyXG4gICAgaW5wdXRzLmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZ09uQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpLnRleHRDb250ZW50ID0gJ1NhdmluZy4uLic7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMb2FkaW5nT25CdXR0b24oKSB7XHJcbiAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJykudGV4dENvbnRlbnQgPSB0aGlzLl9vcmlnaW5hbEJ1dHRvblRleHQ7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZXZ0ID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuaGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcbiIsIi8vIEVsZW1lbnRzXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlJyk7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hZGQtY2FyZCcpO1xyXG5leHBvcnQgY29uc3QgZWRpdEF2YXRhclBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdC1hdmF0YXInKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGUnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fbmFtZScpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVByb2Zlc3Npb24gPSBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hYm91dCcpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUF2YXRhciA9IHByb2ZpbGVDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltZycpO1xyXG5cclxuLy8gSW1hZ2UgUG9wdXAgRWxlbWVudHNcclxuZXhwb3J0IGNvbnN0IGltYWdlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgaW1hZ2VQb3B1cFRpdGxlRWxlbWVudCA9IGltYWdlUG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX190aXRsZV90eXBlX2ltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBpbWFnZVBvcHVwSW1hZ2VFbGVtZW50ID0gaW1hZ2VQb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcblxyXG4vL0J1dHRvbnNcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gcHJvZmlsZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idG4nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRDYXJkRm9ybUJ1dHRvbiA9IHByb2ZpbGVDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idG4nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1nLWJ1dHRvbicpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZVNlbGVjdG9yID0gJyNjYXJkLXRlbXBsYXRlJztcclxuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRzX19saXN0Jyk7XHJcblxyXG5leHBvcnQgY29uc3QgZm9ybVNldHRpbmdzID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fc3VibWl0LWJ0bicsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19zdWJtaXQtYnRuX2Rpc2FibGVkJyxcclxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsXHJcbiAgZXJyb3JDbGFzczogJ3BvcHVwX19lcnJvcl92aXNpYmxlJ1xyXG59O1xyXG5cclxuLy8gRm9ybXMgZWxlbWVudHNcclxuZXhwb3J0IGNvbnN0IGNhcmRBZGRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZC1jYXJkLWZvcm0nKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNlZGl0LXByb2ZpbGUtZm9ybScpO1xyXG5cclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGVkaXRQcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKCcjaW5wdXQtbmFtZScpO1xyXG5leHBvcnQgY29uc3QgcHJvZmVzc2lvbklucHV0ID0gZWRpdFByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNpbnB1dC1wcm9mZXNzaW9uJyk7XHJcbiIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xyXG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZSc7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybSc7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMnO1xyXG5pbXBvcnQge1xyXG4gIGVkaXRQcm9maWxlUG9wdXAsXHJcbiAgYWRkQ2FyZFBvcHVwLFxyXG4gIGVkaXRBdmF0YXJQb3B1cCxcclxuICBwcm9mZXNzaW9uSW5wdXQsXHJcbiAgbmFtZUlucHV0LFxyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVQcm9mZXNzaW9uLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVBZGRDYXJkRm9ybUJ1dHRvbixcclxuICBjYXJkVGVtcGxhdGVTZWxlY3RvcixcclxuICBwcm9maWxlQXZhdGFyLFxyXG4gIHByb2ZpbGVDb250YWluZXIsXHJcbiAgcHJvZmlsZUF2YXRhckJ1dHRvbixcclxuICBmb3JtU2V0dGluZ3NcclxufSBmcm9tICcuLi91dGlscy9jb25zdGFudHMuanMnO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XHJcbmltcG9ydCBBcGkgZnJvbSAnLi4vdXRpbHMvQXBpLmpzJztcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICB1c2VyTmFtZTogcHJvZmlsZU5hbWUsXHJcbiAgdXNlckFib3V0OiBwcm9maWxlUHJvZmVzc2lvbixcclxuICBhdmF0YXI6IHByb2ZpbGVBdmF0YXIsXHJcbiAgdXNlcklkOiBwcm9maWxlQ29udGFpbmVyXHJcbn0pO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogJ2h0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTInLFxyXG4gIHRva2VuOiAnYzc4NWU2OTYtODRhOS00YWNhLWIzZDItNzUwYjI2OTRiNDQ0J1xyXG59KTtcclxuXHJcbmNvbnN0IGNvbmZpcm1hdGlvblBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbignLnBvcHVwX3R5cGVfY29uZmlybScpO1xyXG5cclxuY29uc3QgaW1hZ2VQb3B1cFdpbmRvdyA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnLnBvcHVwX3R5cGVfaW1hZ2UnKTtcclxuXHJcbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcclxuICBjb25zdCB7dXNlck5hbWUsIHVzZXJBYm91dH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpOyAvLyBnZXQgb2JqZWN0IG9mIGN1cnJlbnQgbmFtZSBhbmQgcHJvZmVzc2lvblxyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IHVzZXJOYW1lO1xyXG4gIHByb2Zlc3Npb25JbnB1dC52YWx1ZSA9IHVzZXJBYm91dDtcclxufVxyXG4vLyBJbml0aWFsaXplICBjYXJkc1xyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0pIHtcclxuICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoe1xyXG4gICAgY2FyZERhdGE6IGl0ZW0sXHJcbiAgICBjYXJkVGVtcGxhdGVTZWxlY3RvcixcclxuICAgIG9uSW1hZ2VDbGljazogaW1hZ2VQb3B1cFdpbmRvdy5vcGVuLFxyXG4gICAgdXNlcklkOiBwcm9maWxlQ29udGFpbmVyLmlkLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZENsaWNrOiBpZCA9PiB7XHJcbiAgICAgIGNvbmZpcm1hdGlvblBvcHVwLm9wZW4oKTtcclxuICAgICAgY29uZmlybWF0aW9uUG9wdXAuc2V0U3VibWl0SGFuZGxlcigoKSA9PiB7XHJcbiAgICAgICAgY29uZmlybWF0aW9uUG9wdXAucmVuZGVyTG9hZGluZ09uQnV0dG9uKCk7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAucmVtb3ZlVXNlckNhcmQoaWQpXHJcbiAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIG5ld0NhcmQucmVtb3ZlQ2FyZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgY29uZmlybWF0aW9uUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbmZpcm1hdGlvblBvcHVwLnJlbW92ZUxvYWRpbmdPbkJ1dHRvbigpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGhhbmRsZUxpa2VDYXJkQ2xpY2s6IGlkID0+IHtcclxuICAgICAgY29uc3QgaXNMaWtlZEJ5VXNlciA9IG5ld0NhcmQuaXNMaWtlZEJ5VXNlcigpO1xyXG4gICAgICBpZiAoaXNMaWtlZEJ5VXNlciA9PSB0cnVlKSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAucmVtb3ZlTGlrZShpZClcclxuICAgICAgICAgIC50aGVuKGNhcmQgPT4gbmV3Q2FyZC51cGRhdGVMaWtlQ291bnRlcihjYXJkKSlcclxuICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuYWRkTGlrZShpZClcclxuICAgICAgICAgIC50aGVuKGNhcmQgPT4gbmV3Q2FyZC51cGRhdGVMaWtlQ291bnRlcihjYXJkKSlcclxuICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ld0NhcmQucmVuZGVyQ2FyZCgpO1xyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG59XHJcblxyXG4vL0luaXRpYWxpemEgQ2FyZHNcclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbignLmNhcmRzX19saXN0Jywge1xyXG4gIHJlbmRlcmVyOiByZW5kZXJDYXJkXHJcbn0pO1xyXG5cclxuY29uc3QgcHJvZmlsZVBvcHVwV2luZG93ID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZScsIGFzeW5jICh7bmFtZTogdXNlck5hbWUsIHByb2Zlc3Npb246IHVzZXJBYm91dH0pID0+IHtcclxuICBwcm9maWxlUG9wdXBXaW5kb3cucmVuZGVyTG9hZGluZ09uQnV0dG9uKCk7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmVkaXRQcm9maWxlKHVzZXJOYW1lLCB1c2VyQWJvdXQpO1xyXG4gICAgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHt1c2VyTmFtZSwgdXNlckFib3V0fSk7XHJcbiAgICAgIHByb2ZpbGVQb3B1cFdpbmRvdy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmxvZyhgQ291bGQgbm90IHBlcmZvcm0gcmVxdWVzdDogJHtlcnJvcn1gKTtcclxuICB9XHJcbiAgcHJvZmlsZVBvcHVwV2luZG93LnJlbW92ZUxvYWRpbmdPbkJ1dHRvbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGFkZENhcmRQb3B1cFdpbmRvdyA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9hZGQtY2FyZCcsIGFzeW5jIGRhdGEgPT4ge1xyXG4gIGNvbnN0IHtjYXJkdGl0bGU6IG5hbWUsIGltYWdlbGluazogbGlua30gPSBkYXRhO1xyXG4gIGFkZENhcmRQb3B1cFdpbmRvdy5yZW5kZXJMb2FkaW5nT25CdXR0b24oKTtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuYWRkTmV3Q2FyZChuYW1lLCBsaW5rKTtcclxuICAgIGlmIChyZXNwb25zZSkge1xyXG4gICAgICByZW5kZXJDYXJkKHJlc3BvbnNlKTtcclxuICAgICAgYWRkQ2FyZFBvcHVwV2luZG93LmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUubG9nKGBDb3VsZCBub3QgcGVyZm9ybSByZXF1ZXN0OiAke2Vycm9yfWApO1xyXG4gIH1cclxuICBhZGRDYXJkUG9wdXBXaW5kb3cucmVtb3ZlTG9hZGluZ09uQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhclBvcHVwV2luZG93ID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2VkaXQtYXZhdGFyJywgYXN5bmMgYXZhdGFyID0+IHtcclxuICBjb25zdCB7YXZhdGFyOiBhdmF0YXJVcmx9ID0gYXZhdGFyO1xyXG4gIGVkaXRBdmF0YXJQb3B1cFdpbmRvdy5yZW5kZXJMb2FkaW5nT25CdXR0b24oKTtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZWRpdEF2YXRhcihhdmF0YXJVcmwpO1xyXG4gICAgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoYXZhdGFyVXJsKTtcclxuICAgICAgZWRpdEF2YXRhclBvcHVwV2luZG93LmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUubG9nKGBDb3VsZCBub3QgcGVyZm9ybSByZXF1ZXN0OiAke2Vycm9yfWApO1xyXG4gIH1cclxuICBlZGl0QXZhdGFyUG9wdXBXaW5kb3cucmVtb3ZlTG9hZGluZ09uQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZVBvcHVwV2luZG93LnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmFkZENhcmRQb3B1cFdpbmRvdy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0QXZhdGFyUG9wdXBXaW5kb3cuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGNhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVNldHRpbmdzLCBhZGRDYXJkUG9wdXApO1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1TZXR0aW5ncywgZWRpdFByb2ZpbGVQb3B1cCk7XHJcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtU2V0dGluZ3MsIGVkaXRBdmF0YXJQb3B1cCk7XHJcblxyXG5wcm9maWxlQXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGVkaXRBdmF0YXJQb3B1cFdpbmRvdy5vcGVuKCk7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBwcm9maWxlUG9wdXBXaW5kb3cub3BlbigpO1xyXG4gIGZpbGxQcm9maWxlRm9ybSgpO1xyXG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVBZGRDYXJkRm9ybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXBXaW5kb3cub3BlbigpO1xyXG4gIGNhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmNhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRDYXJkc0FuZFVzZXJEYXRhKClcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgdXNlck5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgIHVzZXJBYm91dDogdXNlckRhdGEuYWJvdXRcclxuICAgIH0pO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlcklkKHVzZXJEYXRhLl9pZCk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJlcihjYXJkcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3Ioe3VzZXJOYW1lLCB1c2VyQWJvdXQsIGF2YXRhciwgdXNlcklkfSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWUgPSB1c2VyTmFtZTtcclxuICAgIHRoaXMuX3VzZXJBYm91dCA9IHVzZXJBYm91dDtcclxuICAgIHRoaXMuX2F2YXRhciA9IGF2YXRhcjtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdXNlck5hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICB1c2VyQWJvdXQ6IHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7dXNlck5hbWUsIHVzZXJBYm91dH0pIHtcclxuICAgIHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50ID0gdXNlck5hbWU7XHJcbiAgICB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQgPSB1c2VyQWJvdXQ7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJZCh1c2VySWQpIHtcclxuICAgIHRoaXMuX3VzZXJJZC5pZCA9IHVzZXJJZDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl90b2tlbiA9IG9wdGlvbnMudG9rZW47XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkc0FuZFVzZXJEYXRhKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJEYXRhKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7YXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW59XHJcbiAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VyRGF0YSgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB7YXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW59XHJcbiAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZSh1c2VyTmFtZSwgdXNlckFib3V0KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdXNlck5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IHVzZXJBYm91dFxyXG4gICAgICB9KVxyXG4gICAgfSkudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGxpbms6IGxpbmtcclxuICAgICAgfSlcclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZVVzZXJDYXJkID0gY2FyZElkID0+IHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfSkudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gIH07XHJcblxyXG4gIGFkZExpa2UgPSBjYXJkSWQgPT4ge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgfTtcclxuXHJcbiAgcmVtb3ZlTGlrZSA9IGNhcmRJZCA9PiB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9O1xyXG5cclxuICBlZGl0QXZhdGFyID0gYXZhdGFyID0+IHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7YXZhdGFyfSlcclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9O1xyXG5cclxuICBfZ2V0UmVzcG9uc2VEYXRhKHJlcykge1xyXG4gICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTsgLy8gdGhpcy5fcG9wdXBcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEhhbmRsZXIoY2FsbCkge1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gY2FsbDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycyA9IGV2dCA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gIH07XHJcblxyXG4gIHJlbmRlckxvYWRpbmdPbkJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKS50ZXh0Q29udGVudCA9ICdMb2FkaW5nLi4uJztcclxuICB9XHJcblxyXG4gIHJlbW92ZUxvYWRpbmdPbkJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKS50ZXh0Q29udGVudCA9ICdZZXMnO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9zZXRFdmVudExpc3RlbmVycyk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbiA9ICh7bGluaywgbmFtZX0pID0+IHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuXHJcbiAgICBjb25zdCBpbWFnZVBvcHVwVGl0bGVFbGVtZW50ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX190aXRsZV90eXBlX2ltYWdlJyk7XHJcbiAgICBjb25zdCBpbWFnZVBvcHVwSW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xyXG5cclxuICAgIGltYWdlUG9wdXBUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgaW1hZ2VQb3B1cEltYWdlRWxlbWVudC5zcmMgPSBsaW5rO1xyXG4gICAgaW1hZ2VQb3B1cEltYWdlRWxlbWVudC5hbHQgPSBuYW1lO1xyXG4gIH07XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoY29udGFpbmVyU2VsZWN0b3IsIHtyZW5kZXJlcn0pIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJlcihpdGVtcykge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwicmVzZXRWYWxpZGF0aW9uIiwiX2lucHV0RWxlbWVudHMiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0ZXh0Q29udGVudCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiYWRkIiwiZGlzYWJsZWQiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJjYXJkRGF0YSIsImNhcmRUZW1wbGF0ZVNlbGVjdG9yIiwib25JbWFnZUNsaWNrIiwidXNlcklkIiwiaGFuZGxlRGVsZXRlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZUNhcmRDbGljayIsIl9lbGVtZW50IiwiX2xpa2VDb3VudGVyIiwibGVuZ3RoIiwiaXNMaWtlZEJ5VXNlciIsIl9hZGRMaWtlQnV0dG9uIiwiX3JlbW92ZUxpa2VCdXR0b24iLCJfbGlrZUJ1dHRvbiIsIl9oYW5kbGVMaWtlQ2FyZENsaWNrIiwiX2NhcmRJZCIsImRlbGV0ZUNhcmRCdXR0b24iLCJfY2FyZFVzZXJJZCIsIl91c2VySWQiLCJfaGFuZGxlRGVsZXRlQ2FyZENsaWNrIiwiX2hhbmRsZVByZXZpZXdQaWN0dXJlIiwiX29uSW1hZ2VDbGljayIsImxpbmsiLCJfbGluayIsIm5hbWUiLCJfbmFtZSIsIl90ZW1wbGF0ZSIsImNsb25lTm9kZSIsImNhcmRJbWFnZSIsImNhcmRMaWtlQ291bnRlciIsInNyYyIsImFsdCIsIl9hZGRFdmVudExpc3RlbmVycyIsIl9yZW5kZXJMaWtlQ29udGFpbmVyIiwib3duZXIiLCJfaWQiLCJsaWtlcyIsImRvY3VtZW50IiwiY29udGVudCIsImxpa2UiLCJ1cGRhdGVMaWtlQ291bnRlciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsInRhcmdldCIsImNvbnRhaW5zIiwiY2xvc2UiLCJrZXkiLCJfcG9wdXAiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX2hhbmRsZU1vdXNlRG93biIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJfZm9ybSIsIl9vcmlnaW5hbEJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dHMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZW5kZXJMb2FkaW5nT25CdXR0b24iLCJyZW1vdmVMb2FkaW5nT25CdXR0b24iLCJzZXRFdmVudExpc3RlbmVycyIsInJlc2V0IiwiZWRpdFByb2ZpbGVQb3B1cCIsImFkZENhcmRQb3B1cCIsImVkaXRBdmF0YXJQb3B1cCIsInByb2ZpbGVDb250YWluZXIiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVQcm9mZXNzaW9uIiwicHJvZmlsZUF2YXRhciIsImltYWdlUG9wdXAiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRDYXJkRm9ybUJ1dHRvbiIsInByb2ZpbGVBdmF0YXJCdXR0b24iLCJmb3JtU2V0dGluZ3MiLCJlZGl0UHJvZmlsZUZvcm0iLCJuYW1lSW5wdXQiLCJwcm9mZXNzaW9uSW5wdXQiLCJ1c2VySW5mbyIsInVzZXJOYW1lIiwidXNlckFib3V0IiwiYXZhdGFyIiwiX3VzZXJOYW1lIiwiX3VzZXJBYm91dCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsInNldFVzZXJJZCIsImFwaSIsIm9wdGlvbnMiLCJjYXJkSWQiLCJmZXRjaCIsIl91cmwiLCJtZXRob2QiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsIl90b2tlbiIsInRoZW4iLCJyZXMiLCJfZ2V0UmVzcG9uc2VEYXRhIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJiYXNlVXJsIiwidG9rZW4iLCJnZXRDYXJkc0FuZFVzZXJEYXRhIiwiUHJvbWlzZSIsImFsbCIsImdldFVzZXJEYXRhIiwiZ2V0SW5pdGlhbENhcmRzIiwiZWRpdFByb2ZpbGUiLCJhYm91dCIsImFkZE5ld0NhcmQiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJjb25maXJtYXRpb25Qb3B1cCIsIl9oYW5kbGVTdWJtaXQiLCJzZXRTdWJtaXRIYW5kbGVyIiwiY2FsbCIsImltYWdlUG9wdXBXaW5kb3ciLCJpbWFnZVBvcHVwVGl0bGVFbGVtZW50IiwiaW1hZ2VQb3B1cEltYWdlRWxlbWVudCIsInJlbmRlckNhcmQiLCJpdGVtIiwibmV3Q2FyZCIsInJlbW92ZVVzZXJDYXJkIiwicmVtb3ZlQ2FyZEVsZW1lbnQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5IiwicmVtb3ZlTGlrZSIsImNhcmQiLCJhZGRMaWtlIiwiY2FyZEVsZW1lbnQiLCJjYXJkU2VjdGlvbiIsImFkZEl0ZW0iLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImVsZW1lbnQiLCJwcmVwZW5kIiwiaXRlbXMiLCJfaXRlbXMiLCJwcm9maWxlUG9wdXBXaW5kb3ciLCJhc3luYyIsInByb2Zlc3Npb24iLCJlcnJvciIsImFkZENhcmRQb3B1cFdpbmRvdyIsImNhcmR0aXRsZSIsImltYWdlbGluayIsImRhdGEiLCJyZXNwb25zZSIsImVkaXRBdmF0YXJQb3B1cFdpbmRvdyIsImF2YXRhclVybCIsImVkaXRBdmF0YXIiLCJjYXJkRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJmaWxsUHJvZmlsZUZvcm0iLCJ1c2VyRGF0YSIsImNhcmRzIl0sInNvdXJjZVJvb3QiOiIifQ==