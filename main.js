!function(){"use strict";var e=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}resetValidation(){this._inputElements.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState(this._inputElements,this._buttonElement)}_hideInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._inputElements.some((e=>!e.validity.valid))?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_showInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class r{constructor(e){let{cardData:r,cardTemplateSelector:n,onImageClick:s,userId:i,handleDeleteCardClick:o,handleLikeCardClick:a}=e;t(this,"_renderLikeContainer",(()=>{this._element.querySelector(".card__like-counter").textContent=this._likeCounter.length,this.isLikedByUser()?this._addLikeButton():this._removeLikeButton()})),t(this,"removeCardElement",(()=>{this._element.remove(),this._element=null})),t(this,"_addEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>this._handleLikeCardClick(this._cardId)));const e=this._element.querySelector(".card__delete-btn");this._cardUserId===this._userId?e.addEventListener("click",(()=>this._handleDeleteCardClick(this._cardId))):e.remove(),this._element.querySelector(".card__img").addEventListener("click",(()=>this._handlePreviewPicture()))})),t(this,"_removeLikeButton",(()=>{this._likeButton.classList.remove("card__like-btn_active")})),t(this,"_addLikeButton",(()=>{this._likeButton.classList.add("card__like-btn_active")})),t(this,"_handlePreviewPicture",(()=>{this._onImageClick({link:this._link,name:this._name})})),t(this,"renderCard",(()=>{this._element=this._template.cloneNode(!0);const e=this._element.querySelector(".card__img"),t=this._element.querySelector(".card__like-counter");return e.src=this._link,e.alt=this._name,t.textContent=this._likeCounter.length,this._element.querySelector(".card__title").textContent=this._name,this._likeButton=this._element.querySelector(".card__like-btn"),this._addEventListeners(),this._renderLikeContainer(),this._element})),this._name=r.name,this._link=r.link,this._cardUserId=r.owner._id,this._cardId=r._id,this._likeCounter=r.likes,this._userId=i,this._onImageClick=s,this._handleDeleteCardClick=o,this._handleLikeCardClick=a,this._template=document.querySelector(n).content.querySelector(".card")}isLikedByUser(){return this._likeCounter.some((e=>e._id===this._userId))}updateLikeCounter(e){this._likeCounter=e.likes,this._renderLikeContainer()}}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class s{constructor(e){n(this,"_handleMouseDown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-btn"))&&this.close()})),n(this,"_handleEscClose",(e=>{e.preventDefault(),"Escape"===e.key&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_visible"),document.addEventListener("keyup",this._handleEscClose),this._popup.addEventListener("mousedown",this._handleMouseDown)}close(){this._popup.classList.remove("popup_visible"),document.removeEventListener("keyup",this._handleEscClose),this._popup.removeEventListener("mousedown",this._handleMouseDown)}}class i extends s{constructor(e,t){super(e),this.handleSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._originalButtonText=this._form.querySelector('button[type="submit"]').textContent}_getInputValues(){const e=[...this._form.querySelectorAll(".popup__input")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}renderLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Saving..."}removeLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent=this._originalButtonText}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.handleSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}}const o=document.querySelector(".popup_type_edit-profile"),a=document.querySelector(".popup_type_add-card"),l=document.querySelector(".popup_type_edit-avatar"),u=document.querySelector(".profile"),c=u.querySelector(".profile__name"),d=u.querySelector(".profile__about"),h=u.querySelector(".profile__img"),_=document.querySelector(".popup_type_image"),p=(_.querySelector(".popup__title_type_image"),_.querySelector(".popup__image"),u.querySelector(".profile__edit-btn")),m=u.querySelector(".profile__add-btn"),v=document.querySelector(".profile__img-button"),y=(document.querySelector(".cards__list"),{inputSelector:".popup__input",submitButtonSelector:".popup__submit-btn",inactiveButtonClass:"popup__submit-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),b=(document.querySelector("#add-card-form"),document.querySelector("#edit-profile-form")),C=b.querySelector("#input-name"),k=b.querySelector("#input-profession");function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const g=new class{constructor(e){let{userName:t,userAbout:r,avatar:n,userId:s}=e;this._userName=t,this._userAbout=r,this._avatar=n,this._userId=s}getUserInfo(){return{userName:this._userName.textContent,userAbout:this._userAbout.textContent,avatar:this._avatar}}setUserInfo(e){let{userName:t,userAbout:r}=e;this._userName.textContent=t,this._userAbout.textContent=r}setUserAvatar(e){this._avatar.src=e}setUserId(e){this._userId.id=e}}({userName:c,userAbout:d,avatar:h,userId:u}),L=new class{constructor(e){f(this,"removeUserCard",(e=>fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"addLike",(e=>fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"removeLike",(e=>fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"editAvatar",(e=>fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>this._getResponseData(e))))),this._url=e.baseUrl,this._token=e.token}getCardsAndUserData(){return Promise.all([this.getUserData(),this.getInitialCards()])}getInitialCards(){return fetch("".concat(this._url,"/cards"),{headers:{authorization:this._token}}).then((e=>this._getResponseData(e)))}getUserData(){return fetch("".concat(this._url,"/users/me"),{headers:{authorization:this._token}}).then((e=>this._getResponseData(e)))}editProfile(e,t){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>this._getResponseData(e)))}addNewCard(e,t){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:{authorization:this._token,"content-type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((e=>this._getResponseData(e)))}_getResponseData(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",token:"c785e696-84a9-4aca-b3d2-750b2694b444"}),E=new class extends s{constructor(e){var t,r;super(e),r=e=>{e.preventDefault(),this._handleSubmit()},(t="_setEventListeners")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this._form=this._popup.querySelector(".popup__form")}setSubmitHandler(e){this._handleSubmit=e}renderLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Loading..."}removeLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Yes"}open(){super.open(),this._form.addEventListener("submit",this._setEventListeners)}close(){super.close(),this._form.removeEventListener("submit",this._setEventListeners)}}(".popup_type_confirm"),S=new class extends s{constructor(e){var t,r;super(e),r=e=>{let{link:t,name:r}=e;super.open();const n=this._popup.querySelector(".popup__title_type_image"),s=this._popup.querySelector(".popup__image");n.textContent=r,s.src=t,s.alt=r},(t="open")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this.open=r}}(".popup_type_image");function q(e){const t=new r({cardData:e,cardTemplateSelector:"#card-template",onImageClick:S.open,userId:u.id,handleDeleteCardClick:e=>{E.open(),E.setSubmitHandler((()=>{E.renderLoadingOnButton(),L.removeUserCard(e).then((()=>{t.removeCardElement(),E.close()})).catch((e=>console.log(e))).finally((()=>{E.removeLoadingOnButton()}))}))},handleLikeCardClick:e=>{1==t.isLikedByUser()?L.removeLike(e).then((e=>t.updateLikeCounter(e))).catch((e=>console.log(e))):L.addLike(e).then((e=>t.updateLikeCounter(e))).catch((e=>console.log(e)))}}),n=t.renderCard();B.addItem(n)}const B=new class{constructor(e,t){let{renderer:r}=t;this._renderer=r,this._container=document.querySelector(e)}addItem(e){this._container.prepend(e)}renderer(e){this._items=e,this._items.forEach((e=>{this._renderer(e)}))}}(".cards__list",{renderer:q}),I=new i(".popup_type_edit-profile",(async e=>{let{name:t,profession:r}=e;I.renderLoadingOnButton();try{await L.editProfile(t,r)&&(g.setUserInfo({userName:t,userAbout:r}),I.close())}catch(e){console.log("Could not perform request: ".concat(e))}I.removeLoadingOnButton()})),w=new i(".popup_type_add-card",(async e=>{const{cardtitle:t,imagelink:r}=e;w.renderLoadingOnButton();try{const e=await L.addNewCard(t,r);e&&(q(e),w.close(),w.removeLoadingOnButton())}catch(e){console.log("Could not perform request: ".concat(e))}w.removeLoadingOnButton()})),D=new i(".popup_type_edit-avatar",(async e=>{const{avatar:t}=e;D.renderLoadingOnButton();try{await L.editAvatar(t)&&(g.setUserAvatar(t),D.close(),D.removeLoadingOnButton())}catch(e){console.log("Could not perform request: ".concat(e))}D.removeLoadingOnButton()}));I.setEventListeners(),w.setEventListeners(),D.setEventListeners();const U=new e(y,a),O=new e(y,o),A=new e(y,l);v.addEventListener("click",(()=>{D.open(),A.resetValidation()})),p.addEventListener("click",(()=>{I.open(),function(){const{userName:e,userAbout:t}=g.getUserInfo();C.value=e,k.value=t}(),O.resetValidation()})),m.addEventListener("click",(()=>{w.open(),U.resetValidation()})),U.enableValidation(),O.enableValidation(),A.enableValidation(),L.getCardsAndUserData().then((e=>{let[t,r]=e;g.setUserInfo({userName:t.name,userAbout:t.about}),g.setUserAvatar(t.avatar),g.setUserId(t._id),B.renderer(r)})).catch((e=>console.log(e)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGlCQUFpQixTQUFTLEtBQ2pEZ0ssRUFBbUI1RyxPQUNuQm9ILEVBQWtCL0wscUJBR3BCK0wsRUFBa0J2SyxtQkFDbEJ5SyxFQUFxQnpLLG1CQUNyQjBLLEVBQW9CMUssbUJBRXBCK0YsRUFDR2lCLHNCQUNBUixNQUFLLElBQXVCLElBQXJCb0UsRUFBVUMsR0FBVyxFQUMzQnpGLEVBQVNRLFlBQVksQ0FDbkJQLFNBQVV1RixFQUFTakosS0FDbkIyRCxVQUFXc0YsRUFBU3RELFFBRXRCbEMsRUFBU1MsY0FBYytFLEVBQVNyRixRQUNoQ0gsRUFBU1UsVUFBVThFLEVBQVN0SSxLQUM1QjJHLEVBQVlHLFNBQVN5QixNQUV0QnJDLE9BQU1DLEdBQU9DLFFBQVFDLElBQUlGLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRFbGVtZW50cywgdGhpcy5fYnV0dG9uRWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCBoYXNJbnZhbGlkSW5wdXQgPSB0aGlzLl9pbnB1dEVsZW1lbnRzLnNvbWUoaW5wdXRFbGVtZW50ID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgaWYgKGhhc0ludmFsaWRJbnB1dCkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gWy4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildOyAvLyBtYWRlIGFycmF5IG9mIG5vZGVMaXN0XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKGlucHV0RWxlbWVudCA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGV2dCA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3Ioe2NhcmREYXRhLCBjYXJkVGVtcGxhdGVTZWxlY3Rvciwgb25JbWFnZUNsaWNrLCB1c2VySWQsIGhhbmRsZURlbGV0ZUNhcmRDbGljaywgaGFuZGxlTGlrZUNhcmRDbGlja30pIHtcclxuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XHJcbiAgICB0aGlzLl9jYXJkVXNlcklkID0gY2FyZERhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5fbGlrZUNvdW50ZXIgPSBjYXJkRGF0YS5saWtlcztcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuXHJcbiAgICB0aGlzLl9vbkltYWdlQ2xpY2sgPSBvbkltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkQ2xpY2sgPSBoYW5kbGVEZWxldGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZENsaWNrID0gaGFuZGxlTGlrZUNhcmRDbGljaztcclxuXHJcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZFRlbXBsYXRlU2VsZWN0b3IpLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLmNhcmQnKTtcclxuICB9XHJcblxyXG4gIGlzTGlrZWRCeVVzZXIoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fbGlrZUNvdW50ZXIuc29tZShsaWtlID0+IGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZUNvdW50ZXIoY2FyZERhdGEpIHtcclxuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gY2FyZERhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlQ29udGFpbmVyKCk7XHJcbiAgfVxyXG5cclxuICBfcmVuZGVyTGlrZUNvbnRhaW5lciA9ICgpID0+IHtcclxuICAgIGNvbnN0IGxpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudGVyJyk7XHJcbiAgICBsaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VDb3VudGVyLmxlbmd0aDtcclxuXHJcbiAgICAhdGhpcy5pc0xpa2VkQnlVc2VyKCkgPyB0aGlzLl9yZW1vdmVMaWtlQnV0dG9uKCkgOiB0aGlzLl9hZGRMaWtlQnV0dG9uKCk7XHJcbiAgfTtcclxuXHJcbiAgcmVtb3ZlQ2FyZEVsZW1lbnQgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfTtcclxuXHJcbiAgX2FkZEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZUxpa2VDYXJkQ2xpY2sodGhpcy5fY2FyZElkKSk7XHJcblxyXG4gICAgY29uc3QgZGVsZXRlQ2FyZEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idG4nKTtcclxuICAgIGlmICh0aGlzLl9jYXJkVXNlcklkID09PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgZGVsZXRlQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUNhcmRDbGljayh0aGlzLl9jYXJkSWQpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGRlbGV0ZUNhcmRCdXR0b24ucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJldmlld1BpY3R1cmUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWcnKTtcclxuICAgIHByZXZpZXdQaWN0dXJlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlUHJldmlld1BpY3R1cmUoKSk7XHJcbiAgfTtcclxuXHJcbiAgX3JlbW92ZUxpa2VCdXR0b24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2xpa2UtYnRuX2FjdGl2ZScpO1xyXG4gIH07XHJcblxyXG4gIF9hZGRMaWtlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ0bl9hY3RpdmUnKTtcclxuICB9O1xyXG5cclxuICBfaGFuZGxlUHJldmlld1BpY3R1cmUgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9vbkltYWdlQ2xpY2soe2xpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWV9KTtcclxuICB9O1xyXG5cclxuICByZW5kZXJDYXJkID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX3RlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltZycpO1xyXG4gICAgY29uc3QgY2FyZExpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudGVyJyk7XHJcbiAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIGNhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgY2FyZExpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZUNvdW50ZXIubGVuZ3RoO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idG4nKTtcclxuICAgIHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fcmVuZGVyTGlrZUNvbnRhaW5lcigpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH07XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF92aXNpYmxlJyk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2hhbmRsZU1vdXNlRG93bik7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX3Zpc2libGUnKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlTW91c2VEb3duKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVNb3VzZURvd24gPSBldnQgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cCcpIHx8IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnRuJykpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IGV2dCA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7IC8vIHRoaXMuX3BvcHVwXHJcbiAgICB0aGlzLmhhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICAgIHRoaXMuX29yaWdpbmFsQnV0dG9uVGV4dCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKS50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0cyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKV07XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG5cclxuICAgIGlucHV0cy5mb3JFYWNoKGlucHV0ID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmdPbkJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKS50ZXh0Q29udGVudCA9ICdTYXZpbmcuLi4nO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlTG9hZGluZ09uQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpLnRleHRDb250ZW50ID0gdGhpcy5fb3JpZ2luYWxCdXR0b25UZXh0O1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGV2dCA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLmhhbmRsZVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCIvLyBFbGVtZW50c1xyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZScpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfYWRkLWNhcmQnKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQtYXZhdGFyJyk7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IHByb2ZpbGVDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX25hbWUnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQcm9mZXNzaW9uID0gcHJvZmlsZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWJvdXQnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBdmF0YXIgPSBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWcnKTtcclxuXHJcbi8vIEltYWdlIFBvcHVwIEVsZW1lbnRzXHJcbmV4cG9ydCBjb25zdCBpbWFnZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGltYWdlUG9wdXBUaXRsZUVsZW1lbnQgPSBpbWFnZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fdGl0bGVfdHlwZV9pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgaW1hZ2VQb3B1cEltYWdlRWxlbWVudCA9IGltYWdlUG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xyXG5cclxuLy9CdXR0b25zXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IHByb2ZpbGVDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnRuJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkQ2FyZEZvcm1CdXR0b24gPSBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnRuJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltZy1idXR0b24nKTtcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGVTZWxlY3RvciA9ICcjY2FyZC10ZW1wbGF0ZSc7XHJcbmV4cG9ydCBjb25zdCBjYXJkc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fbGlzdCcpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1TZXR0aW5ncyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3N1Ym1pdC1idG4nLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fc3VibWl0LWJ0bl9kaXNhYmxlZCcsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZSdcclxufTtcclxuXHJcbi8vIEZvcm1zIGVsZW1lbnRzXHJcbmV4cG9ydCBjb25zdCBjYXJkQWRkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtY2FyZC1mb3JtJyk7XHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdC1wcm9maWxlLWZvcm0nKTtcclxuXHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcignI2lucHV0LW5hbWUnKTtcclxuZXhwb3J0IGNvbnN0IHByb2Zlc3Npb25JbnB1dCA9IGVkaXRQcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKCcjaW5wdXQtcHJvZmVzc2lvbicpO1xyXG4iLCJpbXBvcnQgJy4vaW5kZXguY3NzJztcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJztcclxuaW1wb3J0IENhcmQgZnJvbSAnLi4vY29tcG9uZW50cy9DYXJkLmpzJztcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UnO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0nO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzJztcclxuaW1wb3J0IHtcclxuICBlZGl0UHJvZmlsZVBvcHVwLFxyXG4gIGFkZENhcmRQb3B1cCxcclxuICBlZGl0QXZhdGFyUG9wdXAsXHJcbiAgcHJvZmVzc2lvbklucHV0LFxyXG4gIG5hbWVJbnB1dCxcclxuICBwcm9maWxlTmFtZSxcclxuICBwcm9maWxlUHJvZmVzc2lvbixcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBwcm9maWxlQWRkQ2FyZEZvcm1CdXR0b24sXHJcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgcHJvZmlsZUF2YXRhcixcclxuICBwcm9maWxlQ29udGFpbmVyLFxyXG4gIHByb2ZpbGVBdmF0YXJCdXR0b24sXHJcbiAgZm9ybVNldHRpbmdzXHJcbn0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnO1xyXG5pbXBvcnQgQXBpIGZyb20gJy4uL3V0aWxzL0FwaS5qcyc7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgdXNlck5hbWU6IHByb2ZpbGVOYW1lLFxyXG4gIHVzZXJBYm91dDogcHJvZmlsZVByb2Zlc3Npb24sXHJcbiAgYXZhdGFyOiBwcm9maWxlQXZhdGFyLFxyXG4gIHVzZXJJZDogcHJvZmlsZUNvbnRhaW5lclxyXG59KTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6ICdodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyJyxcclxuICB0b2tlbjogJ2M3ODVlNjk2LTg0YTktNGFjYS1iM2QyLTc1MGIyNjk0YjQ0NCdcclxufSk7XHJcblxyXG5jb25zdCBjb25maXJtYXRpb25Qb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oJy5wb3B1cF90eXBlX2NvbmZpcm0nKTtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXBXaW5kb3cgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF90eXBlX2ltYWdlJyk7XHJcblxyXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XHJcbiAgY29uc3Qge3VzZXJOYW1lLCB1c2VyQWJvdXR9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTsgLy8gZ2V0IG9iamVjdCBvZiBjdXJyZW50IG5hbWUgYW5kIHByb2Zlc3Npb25cclxuICBuYW1lSW5wdXQudmFsdWUgPSB1c2VyTmFtZTtcclxuICBwcm9mZXNzaW9uSW5wdXQudmFsdWUgPSB1c2VyQWJvdXQ7XHJcbn1cclxuLy8gSW5pdGlhbGl6ZSAgY2FyZHNcclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChpdGVtKSB7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKHtcclxuICAgIGNhcmREYXRhOiBpdGVtLFxyXG4gICAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgICBvbkltYWdlQ2xpY2s6IGltYWdlUG9wdXBXaW5kb3cub3BlbixcclxuICAgIHVzZXJJZDogcHJvZmlsZUNvbnRhaW5lci5pZCxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmRDbGljazogaWQgPT4ge1xyXG4gICAgICBjb25maXJtYXRpb25Qb3B1cC5vcGVuKCk7XHJcbiAgICAgIGNvbmZpcm1hdGlvblBvcHVwLnNldFN1Ym1pdEhhbmRsZXIoKCkgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1hdGlvblBvcHVwLnJlbmRlckxvYWRpbmdPbkJ1dHRvbigpO1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLnJlbW92ZVVzZXJDYXJkKGlkKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBuZXdDYXJkLnJlbW92ZUNhcmRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIGNvbmZpcm1hdGlvblBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25maXJtYXRpb25Qb3B1cC5yZW1vdmVMb2FkaW5nT25CdXR0b24oKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBoYW5kbGVMaWtlQ2FyZENsaWNrOiBpZCA9PiB7XHJcbiAgICAgIGNvbnN0IGlzTGlrZWRCeVVzZXIgPSBuZXdDYXJkLmlzTGlrZWRCeVVzZXIoKTtcclxuICAgICAgaWYgKGlzTGlrZWRCeVVzZXIgPT0gdHJ1ZSkge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLnJlbW92ZUxpa2UoaWQpXHJcbiAgICAgICAgICAudGhlbihjYXJkID0+IG5ld0NhcmQudXBkYXRlTGlrZUNvdW50ZXIoY2FyZCkpXHJcbiAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmFkZExpa2UoaWQpXHJcbiAgICAgICAgICAudGhlbihjYXJkID0+IG5ld0NhcmQudXBkYXRlTGlrZUNvdW50ZXIoY2FyZCkpXHJcbiAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXdDYXJkLnJlbmRlckNhcmQoKTtcclxuICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG5cclxuLy9Jbml0aWFsaXphIENhcmRzXHJcbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oJy5jYXJkc19fbGlzdCcsIHtcclxuICByZW5kZXJlcjogcmVuZGVyQ2FyZFxyXG59KTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cFdpbmRvdyA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUnLCBhc3luYyAoe25hbWU6IHVzZXJOYW1lLCBwcm9mZXNzaW9uOiB1c2VyQWJvdXR9KSA9PiB7XHJcbiAgcHJvZmlsZVBvcHVwV2luZG93LnJlbmRlckxvYWRpbmdPbkJ1dHRvbigpO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5lZGl0UHJvZmlsZSh1c2VyTmFtZSwgdXNlckFib3V0KTtcclxuICAgIGlmIChyZXNwb25zZSkge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7dXNlck5hbWUsIHVzZXJBYm91dH0pO1xyXG4gICAgICBwcm9maWxlUG9wdXBXaW5kb3cuY2xvc2UoKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5sb2coYENvdWxkIG5vdCBwZXJmb3JtIHJlcXVlc3Q6ICR7ZXJyb3J9YCk7XHJcbiAgfVxyXG4gIHByb2ZpbGVQb3B1cFdpbmRvdy5yZW1vdmVMb2FkaW5nT25CdXR0b24oKTtcclxufSk7XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXBXaW5kb3cgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfYWRkLWNhcmQnLCBhc3luYyBkYXRhID0+IHtcclxuICBjb25zdCB7Y2FyZHRpdGxlOiBuYW1lLCBpbWFnZWxpbms6IGxpbmt9ID0gZGF0YTtcclxuICBhZGRDYXJkUG9wdXBXaW5kb3cucmVuZGVyTG9hZGluZ09uQnV0dG9uKCk7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmFkZE5ld0NhcmQobmFtZSwgbGluayk7XHJcbiAgICBpZiAocmVzcG9uc2UpIHtcclxuICAgICAgcmVuZGVyQ2FyZChyZXNwb25zZSk7XHJcbiAgICAgIGFkZENhcmRQb3B1cFdpbmRvdy5jbG9zZSgpO1xyXG4gICAgICBhZGRDYXJkUG9wdXBXaW5kb3cucmVtb3ZlTG9hZGluZ09uQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUubG9nKGBDb3VsZCBub3QgcGVyZm9ybSByZXF1ZXN0OiAke2Vycm9yfWApO1xyXG4gIH1cclxuICBhZGRDYXJkUG9wdXBXaW5kb3cucmVtb3ZlTG9hZGluZ09uQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhclBvcHVwV2luZG93ID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2VkaXQtYXZhdGFyJywgYXN5bmMgYXZhdGFyID0+IHtcclxuICBjb25zdCB7YXZhdGFyOiBhdmF0YXJVcmx9ID0gYXZhdGFyO1xyXG4gIGVkaXRBdmF0YXJQb3B1cFdpbmRvdy5yZW5kZXJMb2FkaW5nT25CdXR0b24oKTtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZWRpdEF2YXRhcihhdmF0YXJVcmwpO1xyXG4gICAgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoYXZhdGFyVXJsKTtcclxuICAgICAgZWRpdEF2YXRhclBvcHVwV2luZG93LmNsb3NlKCk7XHJcbiAgICAgIGVkaXRBdmF0YXJQb3B1cFdpbmRvdy5yZW1vdmVMb2FkaW5nT25CdXR0b24oKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5sb2coYENvdWxkIG5vdCBwZXJmb3JtIHJlcXVlc3Q6ICR7ZXJyb3J9YCk7XHJcbiAgfVxyXG4gIGVkaXRBdmF0YXJQb3B1cFdpbmRvdy5yZW1vdmVMb2FkaW5nT25CdXR0b24oKTtcclxufSk7XHJcblxyXG5wcm9maWxlUG9wdXBXaW5kb3cuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkQ2FyZFBvcHVwV2luZG93LnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRBdmF0YXJQb3B1cFdpbmRvdy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgY2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtU2V0dGluZ3MsIGFkZENhcmRQb3B1cCk7XHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVNldHRpbmdzLCBlZGl0UHJvZmlsZVBvcHVwKTtcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1TZXR0aW5ncywgZWRpdEF2YXRhclBvcHVwKTtcclxuXHJcbnByb2ZpbGVBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgZWRpdEF2YXRhclBvcHVwV2luZG93Lm9wZW4oKTtcclxuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIHByb2ZpbGVQb3B1cFdpbmRvdy5vcGVuKCk7XHJcbiAgZmlsbFByb2ZpbGVGb3JtKCk7XHJcbiAgcHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUFkZENhcmRGb3JtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGFkZENhcmRQb3B1cFdpbmRvdy5vcGVuKCk7XHJcbiAgY2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuY2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuYXBpXHJcbiAgLmdldENhcmRzQW5kVXNlckRhdGEoKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICB1c2VyTmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgdXNlckFib3V0OiB1c2VyRGF0YS5hYm91dFxyXG4gICAgfSk7XHJcbiAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySWQodXNlckRhdGEuX2lkKTtcclxuICAgIGNhcmRTZWN0aW9uLnJlbmRlcmVyKGNhcmRzKTtcclxuICB9KVxyXG4gIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7dXNlck5hbWUsIHVzZXJBYm91dCwgYXZhdGFyLCB1c2VySWR9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IHVzZXJOYW1lO1xyXG4gICAgdGhpcy5fdXNlckFib3V0ID0gdXNlckFib3V0O1xyXG4gICAgdGhpcy5fYXZhdGFyID0gYXZhdGFyO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1c2VyTmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIHVzZXJBYm91dDogdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50LFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhclxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHt1c2VyTmFtZSwgdXNlckFib3V0fSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSB1c2VyTmFtZTtcclxuICAgIHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCA9IHVzZXJBYm91dDtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlcklkKHVzZXJJZCkge1xyXG4gICAgdGhpcy5fdXNlcklkLmlkID0gdXNlcklkO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX3VybCA9IG9wdGlvbnMuYmFzZVVybDtcclxuICAgIHRoaXMuX3Rva2VuID0gb3B0aW9ucy50b2tlbjtcclxuICB9XHJcblxyXG4gIGdldENhcmRzQW5kVXNlckRhdGEoKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckRhdGEoKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHthdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbn1cclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJEYXRhKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHthdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbn1cclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9XHJcblxyXG4gIGVkaXRQcm9maWxlKHVzZXJOYW1lLCB1c2VyQWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VyTmFtZSxcclxuICAgICAgICBhYm91dDogdXNlckFib3V0XHJcbiAgICAgIH0pXHJcbiAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKG5hbWUsIGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgbGluazogbGlua1xyXG4gICAgICB9KVxyXG4gICAgfSkudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlVXNlckNhcmQgPSBjYXJkSWQgPT4ge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgfTtcclxuXHJcbiAgYWRkTGlrZSA9IGNhcmRJZCA9PiB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9O1xyXG5cclxuICByZW1vdmVMaWtlID0gY2FyZElkID0+IHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfSkudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gIH07XHJcblxyXG4gIGVkaXRBdmF0YXIgPSBhdmF0YXIgPT4ge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHthdmF0YXJ9KVxyXG4gICAgfSkudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gIH07XHJcblxyXG4gIF9nZXRSZXNwb25zZURhdGEocmVzKSB7XHJcbiAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpOyAvLyB0aGlzLl9wb3B1cFxyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0SGFuZGxlcihjYWxsKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBjYWxsO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gZXZ0ID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcbiAgfTtcclxuXHJcbiAgcmVuZGVyTG9hZGluZ09uQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpLnRleHRDb250ZW50ID0gJ0xvYWRpbmcuLi4nO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlTG9hZGluZ09uQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpLnRleHRDb250ZW50ID0gJ1llcyc7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9zZXRFdmVudExpc3RlbmVycyk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuID0gKHtsaW5rLCBuYW1lfSkgPT4ge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG5cclxuICAgIGNvbnN0IGltYWdlUG9wdXBUaXRsZUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3RpdGxlX3R5cGVfaW1hZ2UnKTtcclxuICAgIGNvbnN0IGltYWdlUG9wdXBJbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcblxyXG4gICAgaW1hZ2VQb3B1cFRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBpbWFnZVBvcHVwSW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7XHJcbiAgICBpbWFnZVBvcHVwSW1hZ2VFbGVtZW50LmFsdCA9IG5hbWU7XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcihjb250YWluZXJTZWxlY3Rvciwge3JlbmRlcmVyfSkge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIHJlbmRlcmVyKGl0ZW1zKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJyZXNldFZhbGlkYXRpb24iLCJfaW5wdXRFbGVtZW50cyIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfYnV0dG9uRWxlbWVudCIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRleHRDb250ZW50Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJhZGQiLCJkaXNhYmxlZCIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zZXRFdmVudExpc3RlbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsImNhcmREYXRhIiwiY2FyZFRlbXBsYXRlU2VsZWN0b3IiLCJvbkltYWdlQ2xpY2siLCJ1c2VySWQiLCJoYW5kbGVEZWxldGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlQ2FyZENsaWNrIiwiX2VsZW1lbnQiLCJfbGlrZUNvdW50ZXIiLCJsZW5ndGgiLCJpc0xpa2VkQnlVc2VyIiwiX2FkZExpa2VCdXR0b24iLCJfcmVtb3ZlTGlrZUJ1dHRvbiIsIl9saWtlQnV0dG9uIiwiX2hhbmRsZUxpa2VDYXJkQ2xpY2siLCJfY2FyZElkIiwiZGVsZXRlQ2FyZEJ1dHRvbiIsIl9jYXJkVXNlcklkIiwiX3VzZXJJZCIsIl9oYW5kbGVEZWxldGVDYXJkQ2xpY2siLCJfaGFuZGxlUHJldmlld1BpY3R1cmUiLCJfb25JbWFnZUNsaWNrIiwibGluayIsIl9saW5rIiwibmFtZSIsIl9uYW1lIiwiX3RlbXBsYXRlIiwiY2xvbmVOb2RlIiwiY2FyZEltYWdlIiwiY2FyZExpa2VDb3VudGVyIiwic3JjIiwiYWx0IiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwiX3JlbmRlckxpa2VDb250YWluZXIiLCJvd25lciIsIl9pZCIsImxpa2VzIiwiZG9jdW1lbnQiLCJjb250ZW50IiwibGlrZSIsInVwZGF0ZUxpa2VDb3VudGVyIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwidGFyZ2V0IiwiY29udGFpbnMiLCJjbG9zZSIsImtleSIsIl9wb3B1cCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlTW91c2VEb3duIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9mb3JtIiwiX29yaWdpbmFsQnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0cyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmdPbkJ1dHRvbiIsInJlbW92ZUxvYWRpbmdPbkJ1dHRvbiIsInNldEV2ZW50TGlzdGVuZXJzIiwicmVzZXQiLCJlZGl0UHJvZmlsZVBvcHVwIiwiYWRkQ2FyZFBvcHVwIiwiZWRpdEF2YXRhclBvcHVwIiwicHJvZmlsZUNvbnRhaW5lciIsInByb2ZpbGVOYW1lIiwicHJvZmlsZVByb2Zlc3Npb24iLCJwcm9maWxlQXZhdGFyIiwiaW1hZ2VQb3B1cCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUFkZENhcmRGb3JtQnV0dG9uIiwicHJvZmlsZUF2YXRhckJ1dHRvbiIsImZvcm1TZXR0aW5ncyIsImVkaXRQcm9maWxlRm9ybSIsIm5hbWVJbnB1dCIsInByb2Zlc3Npb25JbnB1dCIsInVzZXJJbmZvIiwidXNlck5hbWUiLCJ1c2VyQWJvdXQiLCJhdmF0YXIiLCJfdXNlck5hbWUiLCJfdXNlckFib3V0IiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwic2V0VXNlcklkIiwiYXBpIiwib3B0aW9ucyIsImNhcmRJZCIsImZldGNoIiwiX3VybCIsIm1ldGhvZCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiX3Rva2VuIiwidGhlbiIsInJlcyIsIl9nZXRSZXNwb25zZURhdGEiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImJhc2VVcmwiLCJ0b2tlbiIsImdldENhcmRzQW5kVXNlckRhdGEiLCJQcm9taXNlIiwiYWxsIiwiZ2V0VXNlckRhdGEiLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0UHJvZmlsZSIsImFib3V0IiwiYWRkTmV3Q2FyZCIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImNvbmZpcm1hdGlvblBvcHVwIiwiX2hhbmRsZVN1Ym1pdCIsInNldFN1Ym1pdEhhbmRsZXIiLCJjYWxsIiwiaW1hZ2VQb3B1cFdpbmRvdyIsImltYWdlUG9wdXBUaXRsZUVsZW1lbnQiLCJpbWFnZVBvcHVwSW1hZ2VFbGVtZW50IiwicmVuZGVyQ2FyZCIsIml0ZW0iLCJuZXdDYXJkIiwicmVtb3ZlVXNlckNhcmQiLCJyZW1vdmVDYXJkRWxlbWVudCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImZpbmFsbHkiLCJyZW1vdmVMaWtlIiwiY2FyZCIsImFkZExpa2UiLCJjYXJkRWxlbWVudCIsImNhcmRTZWN0aW9uIiwiYWRkSXRlbSIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJpdGVtcyIsIl9pdGVtcyIsInByb2ZpbGVQb3B1cFdpbmRvdyIsImFzeW5jIiwicHJvZmVzc2lvbiIsImVycm9yIiwiYWRkQ2FyZFBvcHVwV2luZG93IiwiY2FyZHRpdGxlIiwiaW1hZ2VsaW5rIiwiZGF0YSIsInJlc3BvbnNlIiwiZWRpdEF2YXRhclBvcHVwV2luZG93IiwiYXZhdGFyVXJsIiwiZWRpdEF2YXRhciIsImNhcmRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsInByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImZpbGxQcm9maWxlRm9ybSIsInVzZXJEYXRhIiwiY2FyZHMiXSwic291cmNlUm9vdCI6IiJ9