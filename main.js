!function(){"use strict";var e=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}resetValidation(){this._inputElements.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState(this._inputElements,this._buttonElement)}_hideInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._inputElements.some((e=>!e.validity.valid))?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_showInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class r{constructor(e){let{cardData:r,cardTemplateSelector:n,onImageClick:s,userId:i,handleDeleteCardClick:o,handleLikeCardClick:a}=e;t(this,"_renderLikeContainer",(()=>{this._element.querySelector(".card__like-counter").textContent=this._likeCounter.length,this.isLikedByUser()?this._addLikeButton():this._removeLikeButton()})),t(this,"removeCardElement",(()=>{this._element.remove(),this._element=null})),t(this,"_addEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>this._handleLikeCardClick(this._cardId)));const e=this._element.querySelector(".card__delete-btn");this._cardUserId===this._userId?e.addEventListener("click",(()=>this._handleDeleteCardClick(this._cardId))):e.remove(),this._element.querySelector(".card__img").addEventListener("click",(()=>this._handlePreviewPicture()))})),t(this,"_removeLikeButton",(()=>{this._likeButton.classList.remove("card__like-btn_active")})),t(this,"_addLikeButton",(()=>{this._likeButton.classList.add("card__like-btn_active")})),t(this,"_handlePreviewPicture",(()=>{this._onImageClick({link:this._link,name:this._name})})),t(this,"renderCard",(()=>{this._element=this._template.cloneNode(!0);const e=this._element.querySelector(".card__img"),t=this._element.querySelector(".card__like-counter");return e.src=this._link,e.alt=this._name,t.textContent=this._likeCounter.length,this._element.querySelector(".card__title").textContent=this._name,this._likeButton=this._element.querySelector(".card__like-btn"),this._addEventListeners(),this._renderLikeContainer(),this._element})),this._name=r.name,this._link=r.link,this._cardUserId=r.owner._id,this._cardId=r._id,this._likeCounter=r.likes,this._userId=i,this._onImageClick=s,this._handleDeleteCardClick=o,this._handleLikeCardClick=a,this._template=document.querySelector(n).content.querySelector(".card")}isLikedByUser(){return this._likeCounter.some((e=>e._id===this._userId))}updateLikeCounter(e){this._likeCounter=e.likes,this._renderLikeContainer()}}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class s{constructor(e){n(this,"_handleMouseDown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-btn"))&&this.close()})),n(this,"_handleEscClose",(e=>{e.preventDefault(),"Escape"===e.key&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_visible"),document.addEventListener("keyup",this._handleEscClose),this._popup.addEventListener("mousedown",this._handleMouseDown)}close(){this._popup.classList.remove("popup_visible"),document.removeEventListener("keyup",this._handleEscClose),this._popup.removeEventListener("mousedown",this._handleMouseDown)}}class i extends s{constructor(e,t){super(e),this.handleSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._originalButtonText=this._form.querySelector('button[type="submit"]').textContent}_getInputValues(){const e=[...this._form.querySelectorAll(".popup__input")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}renderLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Saving..."}removeLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent=this._originalButtonText}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.handleSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}}const o=document.querySelector(".popup_type_edit-profile"),a=document.querySelector(".popup_type_add-card"),l=document.querySelector(".popup_type_edit-avatar"),u=document.querySelector(".profile"),c=u.querySelector(".profile__name"),d=u.querySelector(".profile__about"),h=u.querySelector(".profile__img"),_=document.querySelector(".popup_type_image"),p=(_.querySelector(".popup__title_type_image"),_.querySelector(".popup__image"),u.querySelector(".profile__edit-btn")),m=u.querySelector(".profile__add-btn"),v=document.querySelector(".profile__img-button"),y=(document.querySelector(".cards__list"),{inputSelector:".popup__input",submitButtonSelector:".popup__submit-btn",inactiveButtonClass:"popup__submit-btn_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),b=(document.querySelector("#add-card-form"),document.querySelector("#edit-profile-form")),C=b.querySelector("#input-name"),k=b.querySelector("#input-profession");function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const g=new class{constructor(e){let{userName:t,userAbout:r,avatar:n,userId:s}=e;this._userName=t,this._userAbout=r,this._avatar=n,this._userId=s}getUserInfo(){return{userName:this._userName.textContent,userAbout:this._userAbout.textContent,avatar:this._avatar}}setUserInfo(e){let{userName:t,userAbout:r}=e;this._userName.textContent=t,this._userAbout.textContent=r}setUserAvatar(e){this._avatar.src=e}setUserId(e){this._userId.id=e}}({userName:c,userAbout:d,avatar:h,userId:u}),L=new class{constructor(e){f(this,"removeUserCard",(e=>fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"addLike",(e=>fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"removeLike",(e=>fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._token,"content-type":"application/json"}}).then((e=>this._getResponseData(e))))),f(this,"editAvatar",(e=>fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>this._getResponseData(e))))),this._url=e.baseUrl,this._token=e.token}getCardsAndUserData(){return Promise.all([this.getUserData(),this.getInitialCards()])}getInitialCards(){return fetch("".concat(this._url,"/cards"),{headers:{authorization:this._token}}).then((e=>this._getResponseData(e)))}getUserData(){return fetch("".concat(this._url,"/users/me"),{headers:{authorization:this._token}}).then((e=>this._getResponseData(e)))}editProfile(e,t){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>this._getResponseData(e)))}addNewCard(e,t){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:{authorization:this._token,"content-type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((e=>this._getResponseData(e)))}_getResponseData(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",token:"c785e696-84a9-4aca-b3d2-750b2694b444"}),E=new class extends s{constructor(e){var t,r;super(e),r=e=>{e.preventDefault(),this._handleSubmit()},(t="_setEventListeners")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this._form=this._popup.querySelector(".popup__form")}setSubmitgHandler(e){this._handleSubmit=e}renderLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Loading..."}removeLoadingOnButton(){this._form.querySelector('button[type="submit"]').textContent="Yes"}open(){super.open(),this._form.addEventListener("submit",this._setEventListeners)}close(){super.close(),this._form.removeEventListener("submit",this._setEventListeners)}}(".popup_type_confirm"),S=new class extends s{constructor(e){var t,r;super(e),r=e=>{let{link:t,name:r}=e;super.open();const n=this._popup.querySelector(".popup__title_type_image"),s=this._popup.querySelector(".popup__image");n.textContent=r,s.src=t,s.alt=r},(t="open")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this.open=r}}(".popup_type_image");function q(e){const t=new r({cardData:e,cardTemplateSelector:"#card-template",onImageClick:S.open,userId:u.id,handleDeleteCardClick:e=>{E.open(),E.setSubmitHandler((()=>{E.renderLoadingOnButton(),L.removeUserCard(e).then((()=>{t.removeCardElement(),E.close()})).catch((e=>console.log(e))).finally((()=>{E.removeLoadingOnButton()}))}))},handleLikeCardClick:e=>{1==t.isLikedByUser()?L.removeLike(e).then((e=>t.updateLikeCounter(e))).catch((e=>console.log(e))):L.addLike(e).then((e=>t.updateLikeCounter(e))).catch((e=>console.log(e)))}}),n=t.renderCard();B.addItem(n)}const B=new class{constructor(e,t){let{renderer:r}=t;this._renderer=r,this._container=document.querySelector(e)}addItem(e){this._container.prepend(e)}renderer(e){this._items=e,this._items.forEach((e=>{this._renderer(e)}))}}(".cards__list",{renderer:q}),I=new i(".popup_type_edit-profile",(async e=>{let{name:t,profession:r}=e;I.renderLoadingOnButton();try{await L.editProfile(t,r)&&(g.setUserInfo({userName:t,userAbout:r}),I.close())}catch(e){console.log("Could not perform request: ".concat(e))}I.removeLoadingOnButton()})),w=new i(".popup_type_add-card",(async e=>{const{cardtitle:t,imagelink:r}=e;w.renderLoadingOnButton();try{const e=await L.addNewCard(t,r);e&&(q(e),w.close(),w.removeLoadingOnButton())}catch(e){console.log("Could not perform request: ".concat(e))}w.removeLoadingOnButton()})),D=new i(".popup_type_edit-avatar",(async e=>{const{avatar:t}=e;D.renderLoadingOnButton();try{await L.editAvatar(t)&&(g.setUserAvatar(t),D.close(),D.removeLoadingOnButton())}catch(e){console.log("Could not perform request: ".concat(e))}D.removeLoadingOnButton()}));I.setEventListeners(),w.setEventListeners(),D.setEventListeners();const U=new e(y,a),O=new e(y,o),A=new e(y,l);v.addEventListener("click",(()=>{D.open(),A.resetValidation()})),p.addEventListener("click",(()=>{I.open(),function(){const{userName:e,userAbout:t}=g.getUserInfo();C.value=e,k.value=t}(),O.resetValidation()})),m.addEventListener("click",(()=>{w.open(),U.resetValidation()})),U.enableValidation(),O.enableValidation(),A.enableValidation(),L.getCardsAndUserData().then((e=>{let[t,r]=e;g.setUserInfo({userName:t.name,userAbout:t.about}),g.setUserAvatar(t.avatar),g.setUserId(t._id),B.renderer(r)})).catch((e=>console.log(e)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxpQkFBaUIsU0FBUyxLQUNqRGlLLEVBQW1CN0csT0FDbkJxSCxFQUFrQmhNLHFCQUdwQmdNLEVBQWtCeEssbUJBQ2xCMEssRUFBcUIxSyxtQkFDckIySyxFQUFvQjNLLG1CQUVwQitGLEVBQ0dpQixzQkFDQVIsTUFBSyxJQUF1QixJQUFyQnFFLEVBQVVDLEdBQVcsRUFDM0IxRixFQUFTUSxZQUFZLENBQ25CUCxTQUFVd0YsRUFBU2xKLEtBQ25CMkQsVUFBV3VGLEVBQVN2RCxRQUV0QmxDLEVBQVNTLGNBQWNnRixFQUFTdEYsUUFDaENILEVBQVNVLFVBQVUrRSxFQUFTdkksS0FDNUI0RyxFQUFZRyxTQUFTeUIsTUFFdEJyQyxPQUFNQyxHQUFPQyxRQUFRQyxJQUFJRixLIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKGlucHV0RWxlbWVudCA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0RWxlbWVudHMsIHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgY29uc3QgaGFzSW52YWxpZElucHV0ID0gdGhpcy5faW5wdXRFbGVtZW50cy5zb21lKGlucHV0RWxlbWVudCA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuICAgIGlmIChoYXNJbnZhbGlkSW5wdXQpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IFsuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTsgLy8gbWFkZSBhcnJheSBvZiBub2RlTGlzdFxyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBldnQgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHtjYXJkRGF0YSwgY2FyZFRlbXBsYXRlU2VsZWN0b3IsIG9uSW1hZ2VDbGljaywgdXNlcklkLCBoYW5kbGVEZWxldGVDYXJkQ2xpY2ssIGhhbmRsZUxpa2VDYXJkQ2xpY2t9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFVzZXJJZCA9IGNhcmREYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmREYXRhLl9pZDtcclxuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gY2FyZERhdGEubGlrZXM7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcblxyXG4gICAgdGhpcy5fb25JbWFnZUNsaWNrID0gb25JbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZENsaWNrID0gaGFuZGxlRGVsZXRlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNhcmRDbGljayA9IGhhbmRsZUxpa2VDYXJkQ2xpY2s7XHJcblxyXG4gICAgdGhpcy5fdGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRUZW1wbGF0ZVNlbGVjdG9yKS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJyk7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkQnlVc2VyKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VDb3VudGVyLnNvbWUobGlrZSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpa2VDb3VudGVyKGNhcmREYXRhKSB7XHJcbiAgICB0aGlzLl9saWtlQ291bnRlciA9IGNhcmREYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZUNvbnRhaW5lcigpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VDb250YWluZXIgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBsaWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtY291bnRlcicpO1xyXG4gICAgbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlQ291bnRlci5sZW5ndGg7XHJcblxyXG4gICAgIXRoaXMuaXNMaWtlZEJ5VXNlcigpID8gdGhpcy5fcmVtb3ZlTGlrZUJ1dHRvbigpIDogdGhpcy5fYWRkTGlrZUJ1dHRvbigpO1xyXG4gIH07XHJcblxyXG4gIHJlbW92ZUNhcmRFbGVtZW50ID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIF9hZGRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlQ2FyZENsaWNrKHRoaXMuX2NhcmRJZCkpO1xyXG5cclxuICAgIGNvbnN0IGRlbGV0ZUNhcmRCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnRuJyk7XHJcbiAgICBpZiAodGhpcy5fY2FyZFVzZXJJZCA9PT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgIGRlbGV0ZUNhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDYXJkQ2xpY2sodGhpcy5fY2FyZElkKSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkZWxldGVDYXJkQnV0dG9uLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHByZXZpZXdQaWN0dXJlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1nJyk7XHJcbiAgICBwcmV2aWV3UGljdHVyZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZVByZXZpZXdQaWN0dXJlKCkpO1xyXG4gIH07XHJcblxyXG4gIF9yZW1vdmVMaWtlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19saWtlLWJ0bl9hY3RpdmUnKTtcclxuICB9O1xyXG5cclxuICBfYWRkTGlrZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idG5fYWN0aXZlJyk7XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZVByZXZpZXdQaWN0dXJlID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fb25JbWFnZUNsaWNrKHtsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lfSk7XHJcbiAgfTtcclxuXHJcbiAgcmVuZGVyQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl90ZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWcnKTtcclxuICAgIGNvbnN0IGNhcmRMaWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtY291bnRlcicpO1xyXG4gICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIGNhcmRMaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VDb3VudGVyLmxlbmd0aDtcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnRuJyk7XHJcbiAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX3JlbmRlckxpa2VDb250YWluZXIoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9O1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfdmlzaWJsZScpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVNb3VzZURvd24pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF92aXNpYmxlJyk7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2hhbmRsZU1vdXNlRG93bik7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTW91c2VEb3duID0gZXZ0ID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXAnKSB8fCBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWJ0bicpKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSBldnQgPT4ge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpOyAvLyB0aGlzLl9wb3B1cFxyXG4gICAgdGhpcy5oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XHJcbiAgICB0aGlzLl9vcmlnaW5hbEJ1dHRvblRleHQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJykudGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0JyldO1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuXHJcbiAgICBpbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nT25CdXR0b24oKSB7XHJcbiAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJykudGV4dENvbnRlbnQgPSAnU2F2aW5nLi4uJztcclxuICB9XHJcblxyXG4gIHJlbW92ZUxvYWRpbmdPbkJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKS50ZXh0Q29udGVudCA9IHRoaXMuX29yaWdpbmFsQnV0dG9uVGV4dDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBldnQgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5oYW5kbGVTdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcbn1cclxuIiwiLy8gRWxlbWVudHNcclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUnKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2FkZC1jYXJkJyk7XHJcbmV4cG9ydCBjb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0LWF2YXRhcicpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZScpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlUHJvZmVzc2lvbiA9IHByb2ZpbGVDb250YWluZXIucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Fib3V0Jyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyID0gcHJvZmlsZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1nJyk7XHJcblxyXG4vLyBJbWFnZSBQb3B1cCBFbGVtZW50c1xyXG5leHBvcnQgY29uc3QgaW1hZ2VQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBpbWFnZVBvcHVwVGl0bGVFbGVtZW50ID0gaW1hZ2VQb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3RpdGxlX3R5cGVfaW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGltYWdlUG9wdXBJbWFnZUVsZW1lbnQgPSBpbWFnZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuXHJcbi8vQnV0dG9uc1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBwcm9maWxlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ0bicpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZENhcmRGb3JtQnV0dG9uID0gcHJvZmlsZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ0bicpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWctYnV0dG9uJyk7XHJcblxyXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSAnI2NhcmQtdGVtcGxhdGUnO1xyXG5leHBvcnQgY29uc3QgY2FyZHNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZHNfX2xpc3QnKTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtU2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19zdWJtaXQtYnRuJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX3N1Ym1pdC1idG5fZGlzYWJsZWQnLFxyXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnXHJcbn07XHJcblxyXG4vLyBGb3JtcyBlbGVtZW50c1xyXG5leHBvcnQgY29uc3QgY2FyZEFkZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLWNhcmQtZm9ybScpO1xyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VkaXQtcHJvZmlsZS1mb3JtJyk7XHJcblxyXG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gZWRpdFByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNpbnB1dC1uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9mZXNzaW9uSW5wdXQgPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcignI2lucHV0LXByb2Zlc3Npb24nKTtcclxuIiwiaW1wb3J0ICcuL2luZGV4LmNzcyc7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XHJcbmltcG9ydCBDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gJy4uL2NvbXBvbmVudHMvU2VjdGlvbi5qcyc7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlJztcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtJztcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyc7XHJcbmltcG9ydCB7XHJcbiAgZWRpdFByb2ZpbGVQb3B1cCxcclxuICBhZGRDYXJkUG9wdXAsXHJcbiAgZWRpdEF2YXRhclBvcHVwLFxyXG4gIHByb2Zlc3Npb25JbnB1dCxcclxuICBuYW1lSW5wdXQsXHJcbiAgcHJvZmlsZU5hbWUsXHJcbiAgcHJvZmlsZVByb2Zlc3Npb24sXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZUFkZENhcmRGb3JtQnV0dG9uLFxyXG4gIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxyXG4gIHByb2ZpbGVBdmF0YXIsXHJcbiAgcHJvZmlsZUNvbnRhaW5lcixcclxuICBwcm9maWxlQXZhdGFyQnV0dG9uLFxyXG4gIGZvcm1TZXR0aW5nc1xyXG59IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcclxuaW1wb3J0IEFwaSBmcm9tICcuLi91dGlscy9BcGkuanMnO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIHVzZXJOYW1lOiBwcm9maWxlTmFtZSxcclxuICB1c2VyQWJvdXQ6IHByb2ZpbGVQcm9mZXNzaW9uLFxyXG4gIGF2YXRhcjogcHJvZmlsZUF2YXRhcixcclxuICB1c2VySWQ6IHByb2ZpbGVDb250YWluZXJcclxufSk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMicsXHJcbiAgdG9rZW46ICdjNzg1ZTY5Ni04NGE5LTRhY2EtYjNkMi03NTBiMjY5NGI0NDQnXHJcbn0pO1xyXG5cclxuY29uc3QgY29uZmlybWF0aW9uUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKCcucG9wdXBfdHlwZV9jb25maXJtJyk7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwV2luZG93ID0gbmV3IFBvcHVwV2l0aEltYWdlKCcucG9wdXBfdHlwZV9pbWFnZScpO1xyXG5cclxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xyXG4gIGNvbnN0IHt1c2VyTmFtZSwgdXNlckFib3V0fSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7IC8vIGdldCBvYmplY3Qgb2YgY3VycmVudCBuYW1lIGFuZCBwcm9mZXNzaW9uXHJcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlck5hbWU7XHJcbiAgcHJvZmVzc2lvbklucHV0LnZhbHVlID0gdXNlckFib3V0O1xyXG59XHJcbi8vIEluaXRpYWxpemUgIGNhcmRzXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoaXRlbSkge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZCh7XHJcbiAgICBjYXJkRGF0YTogaXRlbSxcclxuICAgIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxyXG4gICAgb25JbWFnZUNsaWNrOiBpbWFnZVBvcHVwV2luZG93Lm9wZW4sXHJcbiAgICB1c2VySWQ6IHByb2ZpbGVDb250YWluZXIuaWQsXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkQ2xpY2s6IGlkID0+IHtcclxuICAgICAgY29uZmlybWF0aW9uUG9wdXAub3BlbigpO1xyXG4gICAgICBjb25maXJtYXRpb25Qb3B1cC5zZXRTdWJtaXRIYW5kbGVyKCgpID0+IHtcclxuICAgICAgICBjb25maXJtYXRpb25Qb3B1cC5yZW5kZXJMb2FkaW5nT25CdXR0b24oKTtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5yZW1vdmVVc2VyQ2FyZChpZClcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgbmV3Q2FyZC5yZW1vdmVDYXJkRWxlbWVudCgpO1xyXG4gICAgICAgICAgICBjb25maXJtYXRpb25Qb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgY29uZmlybWF0aW9uUG9wdXAucmVtb3ZlTG9hZGluZ09uQnV0dG9uKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgaGFuZGxlTGlrZUNhcmRDbGljazogaWQgPT4ge1xyXG4gICAgICBjb25zdCBpc0xpa2VkQnlVc2VyID0gbmV3Q2FyZC5pc0xpa2VkQnlVc2VyKCk7XHJcbiAgICAgIGlmIChpc0xpa2VkQnlVc2VyID09IHRydWUpIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5yZW1vdmVMaWtlKGlkKVxyXG4gICAgICAgICAgLnRoZW4oY2FyZCA9PiBuZXdDYXJkLnVwZGF0ZUxpa2VDb3VudGVyKGNhcmQpKVxyXG4gICAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5hZGRMaWtlKGlkKVxyXG4gICAgICAgICAgLnRoZW4oY2FyZCA9PiBuZXdDYXJkLnVwZGF0ZUxpa2VDb3VudGVyKGNhcmQpKVxyXG4gICAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3Q2FyZC5yZW5kZXJDYXJkKCk7XHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbn1cclxuXHJcbi8vSW5pdGlhbGl6YSBDYXJkc1xyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKCcuY2FyZHNfX2xpc3QnLCB7XHJcbiAgcmVuZGVyZXI6IHJlbmRlckNhcmRcclxufSk7XHJcblxyXG5jb25zdCBwcm9maWxlUG9wdXBXaW5kb3cgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlJywgYXN5bmMgKHtuYW1lOiB1c2VyTmFtZSwgcHJvZmVzc2lvbjogdXNlckFib3V0fSkgPT4ge1xyXG4gIHByb2ZpbGVQb3B1cFdpbmRvdy5yZW5kZXJMb2FkaW5nT25CdXR0b24oKTtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZWRpdFByb2ZpbGUodXNlck5hbWUsIHVzZXJBYm91dCk7XHJcbiAgICBpZiAocmVzcG9uc2UpIHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe3VzZXJOYW1lLCB1c2VyQWJvdXR9KTtcclxuICAgICAgcHJvZmlsZVBvcHVwV2luZG93LmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUubG9nKGBDb3VsZCBub3QgcGVyZm9ybSByZXF1ZXN0OiAke2Vycm9yfWApO1xyXG4gIH1cclxuICBwcm9maWxlUG9wdXBXaW5kb3cucmVtb3ZlTG9hZGluZ09uQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxuY29uc3QgYWRkQ2FyZFBvcHVwV2luZG93ID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2FkZC1jYXJkJywgYXN5bmMgZGF0YSA9PiB7XHJcbiAgY29uc3Qge2NhcmR0aXRsZTogbmFtZSwgaW1hZ2VsaW5rOiBsaW5rfSA9IGRhdGE7XHJcbiAgYWRkQ2FyZFBvcHVwV2luZG93LnJlbmRlckxvYWRpbmdPbkJ1dHRvbigpO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5hZGROZXdDYXJkKG5hbWUsIGxpbmspO1xyXG4gICAgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgIHJlbmRlckNhcmQocmVzcG9uc2UpO1xyXG4gICAgICBhZGRDYXJkUG9wdXBXaW5kb3cuY2xvc2UoKTtcclxuICAgICAgYWRkQ2FyZFBvcHVwV2luZG93LnJlbW92ZUxvYWRpbmdPbkJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmxvZyhgQ291bGQgbm90IHBlcmZvcm0gcmVxdWVzdDogJHtlcnJvcn1gKTtcclxuICB9XHJcbiAgYWRkQ2FyZFBvcHVwV2luZG93LnJlbW92ZUxvYWRpbmdPbkJ1dHRvbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRBdmF0YXJQb3B1cFdpbmRvdyA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9lZGl0LWF2YXRhcicsIGFzeW5jIGF2YXRhciA9PiB7XHJcbiAgY29uc3Qge2F2YXRhcjogYXZhdGFyVXJsfSA9IGF2YXRhcjtcclxuICBlZGl0QXZhdGFyUG9wdXBXaW5kb3cucmVuZGVyTG9hZGluZ09uQnV0dG9uKCk7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmVkaXRBdmF0YXIoYXZhdGFyVXJsKTtcclxuICAgIGlmIChyZXNwb25zZSkge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGF2YXRhclVybCk7XHJcbiAgICAgIGVkaXRBdmF0YXJQb3B1cFdpbmRvdy5jbG9zZSgpO1xyXG4gICAgICBlZGl0QXZhdGFyUG9wdXBXaW5kb3cucmVtb3ZlTG9hZGluZ09uQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUubG9nKGBDb3VsZCBub3QgcGVyZm9ybSByZXF1ZXN0OiAke2Vycm9yfWApO1xyXG4gIH1cclxuICBlZGl0QXZhdGFyUG9wdXBXaW5kb3cucmVtb3ZlTG9hZGluZ09uQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZVBvcHVwV2luZG93LnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmFkZENhcmRQb3B1cFdpbmRvdy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0QXZhdGFyUG9wdXBXaW5kb3cuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGNhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVNldHRpbmdzLCBhZGRDYXJkUG9wdXApO1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1TZXR0aW5ncywgZWRpdFByb2ZpbGVQb3B1cCk7XHJcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtU2V0dGluZ3MsIGVkaXRBdmF0YXJQb3B1cCk7XHJcblxyXG5wcm9maWxlQXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGVkaXRBdmF0YXJQb3B1cFdpbmRvdy5vcGVuKCk7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBwcm9maWxlUG9wdXBXaW5kb3cub3BlbigpO1xyXG4gIGZpbGxQcm9maWxlRm9ybSgpO1xyXG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVBZGRDYXJkRm9ybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXBXaW5kb3cub3BlbigpO1xyXG4gIGNhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmNhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRDYXJkc0FuZFVzZXJEYXRhKClcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgdXNlck5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgIHVzZXJBYm91dDogdXNlckRhdGEuYWJvdXRcclxuICAgIH0pO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlcklkKHVzZXJEYXRhLl9pZCk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJlcihjYXJkcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3Ioe3VzZXJOYW1lLCB1c2VyQWJvdXQsIGF2YXRhciwgdXNlcklkfSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWUgPSB1c2VyTmFtZTtcclxuICAgIHRoaXMuX3VzZXJBYm91dCA9IHVzZXJBYm91dDtcclxuICAgIHRoaXMuX2F2YXRhciA9IGF2YXRhcjtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdXNlck5hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICB1c2VyQWJvdXQ6IHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7dXNlck5hbWUsIHVzZXJBYm91dH0pIHtcclxuICAgIHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50ID0gdXNlck5hbWU7XHJcbiAgICB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQgPSB1c2VyQWJvdXQ7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJZCh1c2VySWQpIHtcclxuICAgIHRoaXMuX3VzZXJJZC5pZCA9IHVzZXJJZDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl90b2tlbiA9IG9wdGlvbnMudG9rZW47XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkc0FuZFVzZXJEYXRhKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJEYXRhKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7YXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW59XHJcbiAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VyRGF0YSgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB7YXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW59XHJcbiAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZSh1c2VyTmFtZSwgdXNlckFib3V0KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdXNlck5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IHVzZXJBYm91dFxyXG4gICAgICB9KVxyXG4gICAgfSkudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGxpbms6IGxpbmtcclxuICAgICAgfSlcclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZVVzZXJDYXJkID0gY2FyZElkID0+IHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfSkudGhlbihyZXMgPT4gdGhpcy5fZ2V0UmVzcG9uc2VEYXRhKHJlcykpO1xyXG4gIH07XHJcblxyXG4gIGFkZExpa2UgPSBjYXJkSWQgPT4ge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9nZXRSZXNwb25zZURhdGEocmVzKSk7XHJcbiAgfTtcclxuXHJcbiAgcmVtb3ZlTGlrZSA9IGNhcmRJZCA9PiB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9O1xyXG5cclxuICBlZGl0QXZhdGFyID0gYXZhdGFyID0+IHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7YXZhdGFyfSlcclxuICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2dldFJlc3BvbnNlRGF0YShyZXMpKTtcclxuICB9O1xyXG5cclxuICBfZ2V0UmVzcG9uc2VEYXRhKHJlcykge1xyXG4gICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTsgLy8gdGhpcy5fcG9wdXBcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdGdIYW5kbGVyKGNhbGwpIHtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGNhbGw7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSBldnQgPT4ge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcclxuICB9O1xyXG5cclxuICByZW5kZXJMb2FkaW5nT25CdXR0b24oKSB7XHJcbiAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJykudGV4dENvbnRlbnQgPSAnTG9hZGluZy4uLic7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMb2FkaW5nT25CdXR0b24oKSB7XHJcbiAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJykudGV4dENvbnRlbnQgPSAnWWVzJztcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4gPSAoe2xpbmssIG5hbWV9KSA9PiB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcblxyXG4gICAgY29uc3QgaW1hZ2VQb3B1cFRpdGxlRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fdGl0bGVfdHlwZV9pbWFnZScpO1xyXG4gICAgY29uc3QgaW1hZ2VQb3B1cEltYWdlRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuXHJcbiAgICBpbWFnZVBvcHVwVGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIGltYWdlUG9wdXBJbWFnZUVsZW1lbnQuc3JjID0gbGluaztcclxuICAgIGltYWdlUG9wdXBJbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcclxuICB9O1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKGNvbnRhaW5lclNlbGVjdG9yLCB7cmVuZGVyZXJ9KSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyZXIoaXRlbXMpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsInJlc2V0VmFsaWRhdGlvbiIsIl9pbnB1dEVsZW1lbnRzIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsIl9oaWRlSW5wdXRFcnJvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9idXR0b25FbGVtZW50IiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImFkZCIsImRpc2FibGVkIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwicXVlcnlTZWxlY3RvckFsbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiY2FyZERhdGEiLCJjYXJkVGVtcGxhdGVTZWxlY3RvciIsIm9uSW1hZ2VDbGljayIsInVzZXJJZCIsImhhbmRsZURlbGV0ZUNhcmRDbGljayIsImhhbmRsZUxpa2VDYXJkQ2xpY2siLCJfZWxlbWVudCIsIl9saWtlQ291bnRlciIsImxlbmd0aCIsImlzTGlrZWRCeVVzZXIiLCJfYWRkTGlrZUJ1dHRvbiIsIl9yZW1vdmVMaWtlQnV0dG9uIiwiX2xpa2VCdXR0b24iLCJfaGFuZGxlTGlrZUNhcmRDbGljayIsIl9jYXJkSWQiLCJkZWxldGVDYXJkQnV0dG9uIiwiX2NhcmRVc2VySWQiLCJfdXNlcklkIiwiX2hhbmRsZURlbGV0ZUNhcmRDbGljayIsIl9oYW5kbGVQcmV2aWV3UGljdHVyZSIsIl9vbkltYWdlQ2xpY2siLCJsaW5rIiwiX2xpbmsiLCJuYW1lIiwiX25hbWUiLCJfdGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJjYXJkSW1hZ2UiLCJjYXJkTGlrZUNvdW50ZXIiLCJzcmMiLCJhbHQiLCJfYWRkRXZlbnRMaXN0ZW5lcnMiLCJfcmVuZGVyTGlrZUNvbnRhaW5lciIsIm93bmVyIiwiX2lkIiwibGlrZXMiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJsaWtlIiwidXBkYXRlTGlrZUNvdW50ZXIiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJ0YXJnZXQiLCJjb250YWlucyIsImNsb3NlIiwia2V5IiwiX3BvcHVwIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsIl9oYW5kbGVNb3VzZURvd24iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZVN1Ym1pdCIsInN1cGVyIiwiX2Zvcm0iLCJfb3JpZ2luYWxCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZ09uQnV0dG9uIiwicmVtb3ZlTG9hZGluZ09uQnV0dG9uIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJyZXNldCIsImVkaXRQcm9maWxlUG9wdXAiLCJhZGRDYXJkUG9wdXAiLCJlZGl0QXZhdGFyUG9wdXAiLCJwcm9maWxlQ29udGFpbmVyIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlUHJvZmVzc2lvbiIsInByb2ZpbGVBdmF0YXIiLCJpbWFnZVBvcHVwIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQWRkQ2FyZEZvcm1CdXR0b24iLCJwcm9maWxlQXZhdGFyQnV0dG9uIiwiZm9ybVNldHRpbmdzIiwiZWRpdFByb2ZpbGVGb3JtIiwibmFtZUlucHV0IiwicHJvZmVzc2lvbklucHV0IiwidXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJBYm91dCIsImF2YXRhciIsIl91c2VyTmFtZSIsIl91c2VyQWJvdXQiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJzZXRVc2VySWQiLCJhcGkiLCJvcHRpb25zIiwiY2FyZElkIiwiZmV0Y2giLCJfdXJsIiwibWV0aG9kIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJfdG9rZW4iLCJ0aGVuIiwicmVzIiwiX2dldFJlc3BvbnNlRGF0YSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYmFzZVVybCIsInRva2VuIiwiZ2V0Q2FyZHNBbmRVc2VyRGF0YSIsIlByb21pc2UiLCJhbGwiLCJnZXRVc2VyRGF0YSIsImdldEluaXRpYWxDYXJkcyIsImVkaXRQcm9maWxlIiwiYWJvdXQiLCJhZGROZXdDYXJkIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiY29uZmlybWF0aW9uUG9wdXAiLCJfaGFuZGxlU3VibWl0Iiwic2V0U3VibWl0Z0hhbmRsZXIiLCJjYWxsIiwiaW1hZ2VQb3B1cFdpbmRvdyIsImltYWdlUG9wdXBUaXRsZUVsZW1lbnQiLCJpbWFnZVBvcHVwSW1hZ2VFbGVtZW50IiwicmVuZGVyQ2FyZCIsIml0ZW0iLCJuZXdDYXJkIiwic2V0U3VibWl0SGFuZGxlciIsInJlbW92ZVVzZXJDYXJkIiwicmVtb3ZlQ2FyZEVsZW1lbnQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5IiwicmVtb3ZlTGlrZSIsImNhcmQiLCJhZGRMaWtlIiwiY2FyZEVsZW1lbnQiLCJjYXJkU2VjdGlvbiIsImFkZEl0ZW0iLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImVsZW1lbnQiLCJwcmVwZW5kIiwiaXRlbXMiLCJfaXRlbXMiLCJwcm9maWxlUG9wdXBXaW5kb3ciLCJhc3luYyIsInByb2Zlc3Npb24iLCJlcnJvciIsImFkZENhcmRQb3B1cFdpbmRvdyIsImNhcmR0aXRsZSIsImltYWdlbGluayIsImRhdGEiLCJyZXNwb25zZSIsImVkaXRBdmF0YXJQb3B1cFdpbmRvdyIsImF2YXRhclVybCIsImVkaXRBdmF0YXIiLCJjYXJkRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJmaWxsUHJvZmlsZUZvcm0iLCJ1c2VyRGF0YSIsImNhcmRzIl0sInNvdXJjZVJvb3QiOiIifQ==